---
title: "Predictors of dementia after deep brain stimulation in Parkinson´s disease"
subtitle: "DISSERTATION THESIS"
author: "Mgr. Josef Mana"
bibliography: references.bib
format:
  pdf:
    toc: true
    table-of-contents: true
    number-sections: true
    number-depth: 3
warning: false
echo: false
---

```{r}
#| label: init

rm( list = ls() ) # clear environment

# packages
library(here) # reading & saving files
library(tidyverse) # data wrangling
library(gt) # tables formatting
library(english) # number to text conversion
library(ggdag) # directed acyclic graphs
library(ggraph) # help with DAGs plotting
library(brms) # modeling
library(tidybayes) # posterior manipulations
library(emmeans) # contrasts for learning curve analysis
library(bayestestR) # pd and ROPE convenience functions
library(ggridges) # density plots
library(patchwork) # plotting

conflicted::conflicts_prefer(ggdag::filter)
conflicted::conflicts_prefer(tidybayes::hdi)
conflicted::conflicts_prefer(stats::lag)
conflicted::conflict_prefer_all( "brms", quiet = T )
conflicted::conflict_prefer_all( "ggridges", quiet = T )

# in-house functions
rprint <- function( x, dec=2 ) sprintf( paste0("%.",dec,"f"), round( x , dec) ) # printing rounded number
zerolead <- function(x) sub( "0.", ".", x, fixed = T )
ubound <- function( x, dec=2 ) ifelse( round(x,dec) > x, rprint(x,dec), rprint( x+1/(10^dec), dec ) ) # upper bound
msd <- function( x, dec=2 ) paste0( rprint( mean(x,na.rm=T), dec )," ± ", rprint( sd(x,na.rm=T), dec ) ) # descriptives

# folders
sapply( c("figs","tabs","mods"), function(i) if( !dir.exists(i) ) dir.create(i) )

# HMC settings (for lear-curve chapter)
options( mc.cores = parallel::detectCores() ) # use all parallel CPU cores
ch = 4 # number of chains
it = 2000 # iterations per chain
wu = 1000 # warm-up iterations
s = 87542 # seed for reproducibility

```

# Introduction

## Parkinson's disease

Parkinson's disease (PD) is a neurodegenerative disorder first described clinically in 1817 by Dr. James Parkinson in a case series of six patients under the name of "Shaking Palsy" [@parkinson2002]. Between years 1990 and 2016, the age-standardised prevalence rates of PD increased by 21.7% globally causing substantial cost in terms of quality of life and increased death rate [@dorsey2018a]. These data lead several authors to coin the term *"Parkinson Pandemic"* to describe increasing incidence and social costs of PD [@dorsey2018b]. PD is rare in people younger than 50 years of age and its prevalence increases with age. Furthermore, relatively more men are diagnosed with PD than women (in ratio circa 1.4:1) [@dorsey2018a; @armstrong2020].

The defining neuropathological feature of PD is loss of dopaminergic neurons in midbrain's substantia nigra pars compacta and associated insoluble $\alpha$-synuclein aggregates called Lewy bodies [@simon2020]. Dopaminergic denervation of substantia nigra's efferent connections to striatum (putamen and nucleus caudatus) of basal ganglia leads to dysregulation of the function of parallel cortico-striato-thalamico-cortical neural circuits and resulting clinical signs and symptoms [@obeso2000]. Although dopaminergic deficiency within basal ganglia circuits seems to be the major mechanism accounting form most of the core features of PD, other neurotransmitters and brain structures are involved in PD as well contributing to the heterogeneity of PD symptomatology [@braak2003; @kalia2015].

### Motor and non-motor symptoms

The hallmark of PD is parkinsonism comprising of bradykinesia (i.e., slowness of initiation of voluntary movement) combined with muscular rigidity, rest tremor or postural instability [@hughes1992; @litvan2003; @postuma2015]. Supportive criteria for clinical diagnosis of PD further include unilateral onset, persistent asymmetry^[However, the signs should not remain strongly lateralised as strictly unilateral features after three years from diagnosis belong to exclusion criteria for clinical diagnosis of PD.], excellent response to levodopa treatment for five years or more, and progressive long-term clinical course. Although PD is primarily a motor disorder, it is now well established that symptomatology of PD is heterogenous and includes significant non-motor features as well [@kalia2015]. Indeed, some non-motor symptoms such as anxiety, depression, sleep disturbances, gastrointestinal dysfunction and cognitive deficit may be present in high proportion of de novo PD patients and even precede classical motor symptoms of PD [@lima2012; @khoo2013].

Regarding the cognitive symptoms of PD, its ultimate manifestation takes form of Parkinson's disease dementia (PD-D), a disabling non-motor symptom that is present late during disease progression in a substantial number of patients [@aarsland2003; @hely2008]. PD-D is defined by a widespread cognitive deficit that is severe enough to impact patients' daily living [@emre2007; @dubois2007; @goetz2008]. PD-D is further associated with behavioural symptoms such as affective changes, halucinations or apathy as well as high patient and caregiver burden [@emre2007; @leroi2012]. Although the nigrostriatal dopaminergic pathology responsible for motor PD symptoms is well documented, pathophysiological mechanisms of PD-D remain largely unexplained. Contemporary theories assume that PD-D is caused by dysfunction of several dissociable functional brain circuitsm, neurotrasmitter systems, and associated cognitive functions including fronto-striatal executive dysfuncton, fronto-parietal attentional dysfunction, mediotemporal memory dysfunction, and visual perceptual dysfunction due to multiple networks pathology including posterior visual cortices [@gratwicke2015].

### Theories of cognitive dysfunction in PD

One of the most prominent hypotheses of cognitively decline in PD related to this thesis is the Dual-syndrom hypothesis of Trevor Robbins and his collaborators [@kehagia2010; @kehagia2012; @robbins2014]. This hypothesis distinguishes between two basic cognitive/motor phenotypes of PD: (i) patients with tremor as a dominant motor sign who show deficit in tests of planning, working memory and executive functions reflecting fronto-striatal dysfunction with profile of slowly progressing mild cognitive impairment in PD (PD-MCI), and (ii) patients with akinseia and gait disorder as dominant motor signs with early deficit in visuo-spatial functions and semantic memory reflecting posterior parietal and temporal dysfunction and rapid progression to PD-D.


Their theory is based upon observations of prediction to dementia, but see @kim2014b as well.

They further assume continual progression affecting this, then this and then this (Fig 1 in @kehagia2012 ) ... which corresponds well with other theories [@bove2015; @fang2020]. List functions with dysfunctions they map to + say it is important to measure the functions properly, continue to the next section.

### Neuropsychologic evaluation in PD

## Deep brain stimulation

## Measuring cognitive functions

### Clasical test theory and item response theory

### Inference and prediction

[@yarkoni2020; @zhang2023]

### Causal and descriptive targets of inference

# Research Aims

The primary aim of this thesis is to describe pre-surgery cognitive profile of STN DBS treated patients with PD that is prognostic of faster long-term post-surgery rate of cognitive decline. In other words, the thesis ought to indicate which cognitive functions are likely to be impaired already at pre-surgery neuropsychologic assessment in patients that go on to show relatively faster post-surgery cognitive decline. As the answer to this research question is symmetric, this thesis should also indicate which cognitive functions are likely to be relatively unimpaired at pre-surgery assessment in patients that enjoy good long-term post-surgery cognitive performance.

Secondary aims are to enhance our description of pre-surgery cognitive profile prognostic of post-surgery cognitive decline in STN DBS treated PD patients by describing pre-surgery magnetic resonance imaging associated with post-surgery cognitive decline, and to breach the gap between cognitive deficit measured in laboratory settings and its impact on everyday life by examining how PD patients' performance of daily living change after initiating STN DBS treatment.

To achieve these research goals, we begin by showing that psychologically meaningful differences between patients with and without cognitive impairment can be even in principle observed by studying differences in verbal and non-verbal memory learning curves of PD patients with and without diagnosed PD-MCI [@havlik2020]. Next, we present a longitudinal study that includes data of 126 PD patients repeatedly screened for cognitive deficit while being treated by STN DBS [@mana2024]. Discussion of this study will comprise the majority of the thesis as it directly addresses its primary research aim. Finally, we build upon this study by addressing the secondary aims of exploring pre-surgery structural connectivity profile in MRI of patients who experience more severe post-surgery cognitive decline [@filip2024], and relating the objective post-surgery cognitive performance assessed in laboratory settings to patients' subjective difficulty in performing cognitively demanding instrumental activities of daily living [@bezdicek2022].

## Study 1: Learning Curve in Verbal and Non-verbal Memory of Patients with Parkinson's Disease

Declarative memory is one of the cognitive domains that may be impaired even in non-demented PD patients [@bezdicek2018; @domellof2015; @curtis2019]. When taking into account potential mechanisms causing memory deficits in PD which may be either executive (such as retrieval deficit hypothesis) or associative (such as the associative binding hypothesis) [@bezdicek2019; @bronnick2011; @chiaravalloti2014], we can expect there to be differences in immediate recall (i.e., *retention*) and learning over trials (i.e., *slope* or *learning curve*) PD-related deficits. To improve our understanding of these distinctions, Study 1 aims to address following research questions: *RQ1.1)* How do PD patients with and without diagnosis of MCI differ from healthy adults in their visual and verbal memory retention? *RQ1.2)* How do PD patients with and without diagnosis of MCI differ from healthy adults in their visual and verbal memory learning curves? *RQ1.3)* Do differences in retention and learning curve between PD patients with and without diagnosis of MCI and healthy adults vary according to sensory domain?

## Study 2: Preoperative Cognitive Profile Predictive of Cognitive Decline after Subthalamic Deep Brain Stimulation in Parkinson's Disease

STN DBS in PD patients has been associated with heterogenous cognitive outcomes with prior studies reporting findings ranging from small to moderate post-surgery decline in verbal fluency to equivocal results for other cognitive domains [@combs2015; @mehanna2017; @parsons2006]. The ability to predict which patients are likely to develop post-surgery cognitive decline can thus prove useful for patient selection and for guiding post-surgery patient monitoring. The majority of prior studies predicting longitudinal post-surgery cognitive decline employed pre-surgery/post-surgery design with change scores as their dependent variable [@gruber2019; @kim2014] which have a drawback of confounding true change with measurement error [@singer2003]. Furthermore, the focus on change scores allows researchers to estimate group-level post-surgery changes describing their sample but ignores patient-level variability which is necessary to generalize findings beyond the sample [@yarkoni2020]. In Study 2, we aim to predict cognitive true score changes after STN-DBS leveraging a data set that includes three or more observations in large enough number of patients to estimate both group-level post-surgery cognitive decline to describe our sample as well as patient-level variability to provide predictions for other similar samples. To this end, we asked the following research questions: *RQ2.1)* What is the size of expected long-term rate of cognitive decline after STN DBS in PD patients? *RQ2.2)* What is the pre-surgery cognitive profile that is predictive of long-term post-surgery cognitive decline in STN DBS treated PD patients?

## Study 3: Structural and microstructural predictors of cognitive decline in deep brain stimulation of subthalamic nucleus in Parkinson’s disease

Another, increasingly popular modality for predicting post-surgery cognitive decline is pre-surgery profile of anatomy and structural or functional connectivity of patients' brain in MRI [@blume2017; @costentin2019; @planche2018]. Consequently, we follow our results of Study 2 up with longitudinal examination of STN DBS treated patients with PD that also underwent diffusion weighted imaging (DWI) and structural MRI before surgery. The research question was *RQ3.1)* What is the pre-surgery profile of structural integrity and microstructural connectivity in MRI that is predictive of long-term post-surgery cognitive decline in STN DBS treated PD patients?

## Study 4: The Instrumental Activities of Daily Living in Parkinson’s Disease Patients Treated by Subthalamic Deep Brain Stimulation

Whereas studies 1-3 focus on describing patients' in-laboratory cognitive performance, Study 4 aims to bridge the gap between cognitive deficit detectable by objective cognitive testing and patients' subjective assessment of its impact on everyday living. Activities of daily living (ADL) play a crucial role in this aspect as absence or presence of cognitively caused ADL deficit differentiates between PD-MCI and PD-D [@dubois2007; @litvan2012]. Specifically, cognitively demanding instrumental ADL (IADL) such as following instructions or doing more than one thing at a time may be impaired in PD indicating progression of cognitive decline [@brennan2016]. In Study 4 we aim to document post-surgery IADL changes of PD patients and estimate causal effect of dopaminergic medication level as a potentially easy-to-intervene-on factor to moderate post-surgery IADL. Following research questons were addressed in this study: *RQ4.1)* What is the size of change in self-reported IADL one year after STN DBS compared to pre-surgery IADL level in PD patients? *RQ4.2)* What is the size of one year post-surgery self-reported IADL change that can be attributed to time and STN DBS effects rather than other post-surgery factors? *RQ4.3)* How does one year post-surgery self-reported IADL change in response to adjusting levels of dopaminergic medication?

# Methods

## Learning curve in verbal and non-verbal memory of patients with Parkinson's disease

### Participants

The study involved 60 patients with PD recruited from the Movement Disorders Center, Department of Neurology at First Faculty of Medicine and General University Hospital in Prague, and 60 age and sex matched healthy adults recruited for the National Normative Study of Cognitive Determinants of Healthy Aging [@stepankova2015]. The exclusion criteria were as follows: PD-D according to Movement Disorder Society criteria [@dubois2007; @emre2007], atypical or secondary parkinsonism, severe or unstable depression, psychotic symptoms (hal- lucinations or delusions) including those caused by medication, anticholinergic medications, and other medical or neurological conditions potentially resulting in cognitive impairment (e.g., history of seizure, stroke, or head trauma). All patients were examined in the “on” motor state. Patients were further divided to patients with normal cognition (PD-NC) and patients with mild cognitive impairment (PD-MCI) according to their performance on test battery described below.

### Measures

All participants were examined with the Montreal cognitive assessment (MoCA) screening test for signs of overall cognitive deterioration [@kopecek2017; @nasreddine2005]. The healthy control group was further examined via a complex test battery [@stepankova2015] whereas PD patients underwent a standardized battery for PD-MCI according to the Movement Disorder Society Task Force Level II criteria [@bezdicek2017; @bezdicek2017b; @litvan2012]. For the purposes of the current study, only the Czech versions of Brief Visuospatial Memory Test (BVMT-R) [@benedict1997] and Rey Auditory Verbal Learning Test (RAVLT) [@bezdicek2014] were analysed.

The BVMT-R is a test of visual and spatial declarative memory consisting of a grid of six figures for the participant to remember and draw after 10 seconds of exposure. The stimulus sheet is presented to the participant three times resulting in three 0-12 scores (maximum two point per figure) representing visuospatial *retention* (the first trial) as well as visuospatial *learning curve* (difference between succesive further trials). The test further includes delayed free recall and delayed recognition trials [@benedict1997] which were not analysed in this thesis.

The RAVLT is a test of verbal declarative memory consisting of a list of 15 words presented in five consecutive trials always followed by the immediate recall. Consequently, the data consist of five 0-15 scores (one point for each word correctly recalled) representing verbal *retention* (the first trial) as well as verbal *learning curve* (difference between succesive further trials). The test further includes interfering list recall, post-interference recall, delayed free recall, delayed recognition, and delayed recognition with forced-choice [@bezdicek2014; @frydrychova2018] which were not analysed in this thesis.

### Statistical analyses

RAVLT and BVMT-R data were analyzed using Bayesian generalized linear mixed models (GLMMs) [@tuerlinckx2006; @gelman2006; @mcelreath2020]. Single trial scores were used as outcomes for separate RAVLT and BVMT-R GLMMs with two level of predictors: (i) natural logarithm of trial order, group (HC, PD-NC and PD-MCI) and their interaction on a group level, and (ii) correlated varying participant-specific intercepts and slopes based on natural logarithm of trial order at the participant level. Outcome variables as well as trial order were treated as continuous and modeled with Gaussian measurement error model for both outcome variables. Improper flat priors over reals were set-up for population-level parameters, half student-t priors with 3 degrees of freedom for global intercept and group-level parameters, and non-regularising LKJ(1) [@lewandowsi2009] prior for participant-level correlation matrices.

To evaluate the memory profile of PD patients in RAVLT and BVMT-R, we first estimated difference between group-specific marginal means across trials (main effects contrasts). Although difference in these marginal means indicates potential memory deficit in some of the groups, it does not indicate whether the deficit is due to impaired *retention* or impaired *learning curve*. We thus also compared between-group differences in marginal means of the first trial performance (simple effect contrasts) as a measure of *retention*, and between-group differences in marginal trends of the logarithmic trial order parameter (interaction contrasts) as a mesure of *learning curve*. All estimates were described by their 95% highest density posterior intervals (HDPI) and compared via the Probability of Direction (*pd*) as an index of effect existence. Marginal means were also compared via percentage in region of practical equivalence (*ROPE*) as an index of effect significance. *ROPE* was set to an interval ranging from −0.1 to 0.1 of the standard deviation of the outcome variable according to the Czech normative data. The results were interpreted following reporting guidelines for Bayesian analyses as articulated by @makowski2019.

All GLMMs were fitted using via Stan’s (version `r rstan::stan_version()`) build-in Hamiltonian Monte Carlo (HMC) sampler accessed via R software for statistical computing version `r with( version, paste(major,minor,sep=".") )` using package “brms” [@bürkner2017; @rsoft; @stan]. Four parallel chains were run each for 2,000 iterations for each GLMM. The first 1,000 iterations served as a warm-up and were discarded. Convergence was checked numerically by inspection of the $\hat{R}s$ and visually by inspection of trace plots. Full analysis code is available at <https://github.com/josefmana/pd_learCUR.git>.

## Preoperative Cognitive Profile Predictive of Cognitive Decline after Subthalamic Deep Brain Stimulation in Parkinson's Disease

### Participants

```{r}
#| label: cog-pred-init

# read the data set and prepare subsets for individual analyses
d0 <- read.csv( here("_data","cogPRED_data.csv") , sep = "," )
d1 <- d0[ d0$included == 1 , ] # only STN-DBS treated patients with pre- and post-surgery data
d2 <- d1[ d1$ass_type == "pre" , ] # only pre-surgery assessments of included patients

# read a file containing mapping of variables' names used in the script to variables' names for the manuscript
v <- read.csv( here("_data","var_nms.csv") , sep = ";" , row.names = 1 , encoding = "UTF-8")

# IN-TEXT STATS ----

itstats <-
  
  with(
    
    d1, list(
      
      # number of patients
    n = c( tot = length( unique(d0$id) ), incl = length( unique(id) ) ),
    
    # duration of follow-up
    fudur =
      
      sapply(
        c("mean","sd","median","min","max"), # stats to compute
        function(i)
          do.call( i, list( time_y[ complete.cases(drs_tot) & ass_type != "pre" ] ) ) %>%
          rprint(2)
      ),
    
    # number of assessments per patient
    nass =
      
      sapply(
        c("median","min","max"),
        function(i) do.call( i, list( table( id[ complete.cases(drs_tot) ] ) ) )
      )
      
    )
  )

```

The study involved `r itstats[['n']][['incl']]` patients with idiopathic PD following United Kingdom Parkinson’s Disease Society Brain Bank Criteria [@hughes1992] that underwent surgery for STN DBS treatment at the Movement Disorders Center, Department of Neurology at First Faculty of Medicine and General University Hospital in Prague between years 2000 and 2020 and were repeatedly screened for overall cognitive performance in ensuing years. Exclusion criteria were contingent upon patients being suitable candidates for STN DBS treatment and followed the Core assessment program for surgical interventional therapies in Parkinson’s disease (CAPSIT) protocol [@defer1999], consequently, patients with atypical parkinsonian syndromes, dementia, depression at the time of pre-surgery assessment, recurrent psychotic conditions or a gait disorder despite optimal dopaminergic therapy during pre-surgery assessment were not implanted and were thus not included into the study.

### Neropsychological examination

Pre-surgery neuropsychological assessment examined the following cognitive domains: (i) attention via Trail Making Test, part A (TMT-A) [@bezdicek2012; @bezdicek2017a; @partington1949] and dot color naming condition from Prague Stroop Test (PST-D) [@bezdicek2015a] for sustained visual attention; (ii) executive functions via Trail Making Test, part B (TMT-B) [@bezdicek2012; @bezdicek2017a; @partington1949] for set shifting, Tower of London task (TOL) [@michalec2017; @shallice1982] for planning, Prague Stroop Test, naming color of neutral words (PST-W) and interference condition (i.e., naming color of contrasting color words, PST-C) for sensitivity to interference [@bezdicek2015a], and Controlled Oral Word Association Test (COWAT, letters K + P) [@nikolai2015] for mental flexibility; (iii) language via Similarities (Sim.) from Wechsler Adult Intelligence Scale, third revision (WAIS-III) [@wechsler2010] for conceptualization, and category verbal fluency test (CFT, category Animals) [@nikolai2015] for speeded word production; (iv) working memory via Digit Span forward and backward (DS-F and DS-B) from WAIS-III [@wechsler2010] as well as letter-number sequencing (LNS) [@wechsler2011] and Spatial Span forward and backward (SS-F and SS-B) from Wechsler Memory Scale, third edition (WMS-III) [@wechsler2011] for auditory and spatial working memory respectively; and (v) memory via Rey Auditory Verbal Learning Test (RAVLT) [@bezdicek2014; @frydrychova2018] for explicit verbal learning and memory, and WMS-III Family Pictures (FP) for visuo-spatial memory [@wechsler2011]. Furthermore, anxiety was assessed with the State-Trait Anxiety Inventory for the state (STAI-X1) and trait (STAI-X2) anxiety [@spielberger1983].

Patients’ longitudinal cognitive state was assessed pre-surgery and at several times post-surgery using Mattis Dementia Rating Scale, second edition (MDRS) [@bezdicek2015; @jurica2001]. Moreover, subjective depressive symptoms were assessed with Beck Depression Inventory, second edition (BDI-II) [@beck1996; @ciharova2020] at each assessment. BDI-II was not used for pre-surgery exclusion due to depression which was instead ascertained by an independent neuropsychiatric evaluation. Finally, The levodopa equivalent daily dose (LEDD) was calculated at each assessment time-point according to @tomlinson2010.

### Estimands

Theoretical estimands linked to each research question of this study and their mapping to statistical estimators according to framework of @lundberg2021 are presented in @tbl-long-cog-estimands. Regarding our *RQ2.1*, we aimed to estimate the expected cognitive decline on two levels of generalisation: (i) the current sample and (ii) a population of patients selected for DBS treatment via the CAPSIT-protocol criteria [@defer1999]. Whereas virtually all previous studies examining long-term cognitive changes after STN DBS constraint their conclusions to sample-level estimates as even studies employing GLMMs elected to report fixed-effects only [@boel2016; @pal2022], in this study we leveraged the hierarchical structure of GLMMs to provide both sample- and population-level estimates. To allow for this generalisation, we assume exchangeability between patients selected via CAPSIT criteria to the extend that can be quantified by patient-level variance estimated from our sample [see @yarkoni2020]. Empirical estimands were the same unit-specific quantities as those presented in @tbl-long-cog-estimands, conditional on patient being selected for the study (based on geographical and exclusion criteria described above). Importantly, all three estimands are descriptive, not causal.

| Research question                                                                                                                        |                                                                                                                                                 Estimand (unit specific quantity)                                                                                                                                                 |     Estimand (population)      |                                                Statistical estimator                                                 |
|-------------|:--------------------------------:|:-----------:|:-----------:|
| What is the size of expected long-term rate of cognitive decline after STN DBS in PD patients?                                           |                                                                                                        Difference between expected post-surgery cognitive performance and expected cognitive performance *k* years before                                                                                                         |         Current sample         |                                      $\mu_i$ = $\alpha$ + $\delta_{time}time_i$                                      |
|                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                   | CAPSIT-based selected patients |                $\mu_i$ = $\alpha$ + $\delta_{time}time_i$ + $\alpha_{id[i]}$ + $\delta_{id[i]}time_i$                |
| What is the pre-surgery cognitive profile that is predictive of long-term post-surgery cognitive decline in STN DBS treated PD patients? | Difference between expected post-surgery cognitive decline of a patient with fixed level of pre-surgery performance across all cognitive factors and expected post-surgery cognitive decline of patients with performance that is one unit smaller in a single cognitive factor but equal to this patient’s performance otherwise |         Current sample         | $\mu_i$ = $\alpha$ + $\delta_{time}time_i$ + $\sum_jfactor_{[j]i}$($\beta_{factor[j]}$ + $\delta_{factor[j]}time_i$) |

: Mapping of research questions to estimands to qunatities to be estimated in the study. {#tbl-long-cog-estimands}

### Statistical analyses

Pre-surgery cognitive battery was pre-processed via via an exploratory factor analysis (EFA) with varimax rotation using ordinary least squares to find the minimum residual solution [@harman1966]. All pre-surgery cognitive tests were entered into EFA as input variables. Missing observations were multiply imputed using a parametric bootstrap via the “missMDA” R package to create one hundred imputed data sets. We then computed EFA with three up to eight factors via the “psych” R package [@rsoft; @missMDA; @psych] using each imputed data set. Within each imputed data set, factor scores for each patient were calculated using the regression method [@thomson1951]. The number of extracted factors was based on a combination of the root-mean-square error approximation (RMSEA), Tucker-Lewis Index (TLI), and consistency of each factor model across imputations. TLI is a measure of a goodness-of-fit such that higher values of TLI imply better fit and values exceeding 0.90 are considered to indicate a good model fit. On the other hand, RMSEA is a measure of badness-of-fit such that lower values imply better fit with values less than 0.08 indicating an adequate model fit [@browne1992]. A model was considered consistent if it identified similar factors across imputed data sets.

To describe the rate of post-surgery cognitive decline, we estimated a GLMM with longitudinal MDRS performance as an outcome predicted by the time after surgery on the group-level and correlated patient-specific intercepts and slopes on the patient-level. The group-level slope of this model constituted statistical estimate of the sample version of our *RQ2.1* estimand (i.e., the expected annual cognitive decline in the sample). To arrive at statistical estimate of the population version of our *RQ2.1* estimand (i.e., the expected annual cognitive decline in a population of patients selected for surgery using CAPSIT-protocol criteria) we used the model to predict expected post-surgery cognitive decline at one year post-surgery intervals compared to a pre-surgery assessment using both group- and patient-level parameters.

To evaluate predictive utility of pre-surgery cognitive profile, we estimated further two GLMMs. Longitudinal MDRS performance was predicted on a group-level by post-surgery time slopes varying by either patients’ pre-surgery cognitive tests’ scores (the “test scores” model) or patients’ pre-surgery latent cognitive factors’ scores extracted from the EFA reported above (the “factor scores” model). Both models further included correlated patient-level intercepts and slopes. Since MDRS scores may include significant outliers, we used Studdent-t instead of Gaussian measurement error model. Furthermore, because the outcome MDRS has a maximum of 144 points which is achieved by a large proportion of healthy people [@bezdicek2015], the right-censored version of Student-t was used to account for the ceiling effect. Estimands relating to *RQ2.2* comprised of the two sets of interaction coefficients representing the expected prognostic value of single pre-surgery cognitive tests and latent cognitive factors. We specified equivalent prior distributions for model parameters of both the “test scores” and the “factor scores” models, most importantly the Bayesian Lasso priors for were used all group-level parameters barring the intercept [@park2008].

Estimates were described by full posterior distributions, medians and 95% highest density posterior probability intervals (HDPIs) of corresponding model parameters or predictions as appropriate. When presenting results for the second version of *RQ2.1* estimand, we report medians and 90% equal-tailed posterior probability intervals (ETIs) instead. A 90% ETI can be interpreted such that a given parameter or prediction lies with 5% probability above its upper bound and with 5% probability below its lower bound. Time-dependent parameters are denoted $\delta$ and time-independent parameters are denoted $\beta$ throughout.

All GLMMs were fitted using via Stan’s (version `r rstan::stan_version()`) build-in HMC sampler accessed via R version `r with( version, paste(major,minor,sep=".") )` using package “brms” [@bürkner2017; @rsoft; @stan]. Four parallel chains were run each for 2,500 iterations for each GLMM. The first 500 iterations served as a warm-up and were discarded. Convergence was checked numerically by inspection of the $\hat{R}s$ and visually by inspection of trace plots. R package “tidyverse” was used for data operations, “tidybayes” was used for operations with model posteriors, and "ggridges," and “patchwork” were used for plotting [@tidyverse; @tidybayes; @ggplot2; @ggridges; @patchwork]. Full analysis code is available at <https://github.com/josefmana/dbs_cogPRED.git>.

## Structural and microstructural predictors of cognitive decline in deep brain stimulation of subthalamic nucleus in Parkinson’s disease

### Participants

The study involved 72 patients with PD diagnosed according to the criteria for clinically established PD defined by the Movement Disorders Society [@postuma2015] that were indicated for STN DBS. Exclusion criteria were general contraindications to MRI examination (see Study 2), substantial vascular or space occupying brain lesions or a neurological or psychiatric disorder other than PD and its related complications. The examination of cognition (via MDRS) was performed before the STN DBS implantation and then in the years 1, 3 and 5 after the surgery with the last available assessment, i.e. with the longest follow-up duration, being used to calculate the MDRS change per year ($\Delta$MDRS = $\frac{\text{MDRS}_{post} - \text{MDRS}_{pre}}{\text{Years post-surgery}}$ ). Patients with $\Delta$MDRS of --2 or less were labelled as cognitive decline (CD) group, the remaining patients were considered cognitively stable (CS).[^1] Furthermore, at each measurement occassion, patients' cognitive state was categorised as PD-MCI or PD-NC based on MDRS cutoff 139/140 derived from the Czech normative study as threshold with the best specificity and sensitivity (both \~ .80 ) [@bezdicek2015].

[^1]: This choice was based on the reasoning that patient that would scored at maximal 144/144 points before sugery would with 2 points/year decline reach the optimal threshold for PD-MCI according to the Czech normative study [@bezdicek2015] at three-year post-surgery mark.

Pre-surgery MRI acquisition was performed using a 3T MAGNETOM Skyra scanner (Siemens, Erlangen, Germany). A T1-weighted (T1w) scan was acquired with magnetisation-prepared rapid gradient echo (MPRAGE) sequence, 1.0-mm isotropic resolution, repetition time (TR) = 2,200 ms, inversion time (TI) = 900 ms, echo time (TE) = 2.43 ms, and flip angle (FA) = $8^\circ$. The protocol further included DWI with voxel size 2.0 × 2.0 × 2.0 mm^3^, TR = 9,000 ms, TE = 94 ms, FA = $90^\circ$, single b-value of 1100 s/mm^2^, and 30 directions with 5 additional b0 images, acquired with antero-posterior phase encoding direction. Post-surgery T1w scan with MPRAGE sequence, 1.0 mm isotropic resolution, TR = 2,140 ms, TI = 1,100 ms, TE = 3.93 ms, and FA == 15° acquired using a 1.5 T MAGNETOM Avanto scanner (Siemens, Erlangen, Germany) was utilised to estimate the position of the DBS electrode.

### MRI data processing

For a full MRI data processing pipeline, see the source article [@filip2024]. Shortly, the goal of MRI processing was to (i) transform the raw T1w images from their native space to standardized Montreal Neurilogical Institute (MNI) space [@grabner2006] to guide connectivity analyses and estimate subcortical grey matter volumes, (ii) extract anatomical connectivity metrics from DWI images, and (iii) extract cortical thickness estimates. Pre-processing steps followed the minimal preprocessing pipelines for the Human Connectome Project leading to set of standard Connectivity Informatics Technology Initiative (CIFTI) files in grayordinate space [@glasser2013]. This process resulted in extracting following predictor of interest: (i) fractional anisotropy (FA) and mean diffusivity (MD) as proxies of microstructural connectivity, and (ii) cortical thickness and subcortical grey matter (based on 69 subcortical regions of interest) as proxies of macrostructural integrity. Lastly, Lead-DBS software version 2.5.3 [@horn2015; @horn2019] was utilized to determine the position of DBS leads and active contacts with DISTAL subcortical atlas for STN compartmentalization [@ewert2018]. The overlap of volume of affected tissue at the time of last recorded cognitive assessment (VAT) and the entire STN as well as its motor, associative, and limbic components separately was calculated, providing four overlap volumes for each side.

### Statistical analyses

Outcome data were descibed separately for CS and CD groups. Means of continuous variables were compared between groups using two-sample, two-tailed T-tests whereas frequency tables of nominal variables were were compared using Fisher's exact test. Differences were considered statistically significant if their *q*-value was lower than .05 after adjusting for 5% False Discovery Rate (FDR)[@benjamini1995; @benjamini2001]. To analyse microstructural and macrostructural correlates of pre-surgery cognitive state and post-surgery cognitive decline, two sets of General Linear Models (GLMs) were fitted with region-specific microstructural (FA and MD) and macrostructural (cortical thickness and subcortical grey matter volume) measures as outcomes, pre-surgery MDRS score or group (CD versus CS) as primary predictors, and age, sex and disease duration as covariates. Statistical significance of resulting regression coefficients of primary predictors was decided based on non-parametric analysis as implemented in the Permutation Analysis of Linear Models package with 10,000 permutations and FDR correction over the number of parcels separately for each modality [@winkler2014]. Results were considered significant at adjusted *q*-value \< .05 and parcel cluster size equal or above 2 to eliminate singleton cortical parcels.

## The Instrumental Activities of Daily Living in Parkinson’s Disease Patients Treated by Subthalamic Deep Brain Stimulation

### Participants

The study involved 32 patients with PD diagnosed according to the criteria for clinically established PD defined by the Movement Disorders Society [@postuma2015] that were indicated for STN DBS with identical exclusion criteria as in Study 2 and Study 3 (except for the MRI-specific exclusion criteria of Study 3). All PD patients were under dopaminergic therapy (i.e., levodopa, dopamine agonist, or a combination of them), and levodopa’s equivalent daily dose (LEDD) for each patient was calculated before and after surgery [@tomlinson2010].

### Assessments

Both pre-surgery and post-surgery neuropsychological assessment was performed in accordance with published reccomendations [@kubu2018] and included cognitive screening via Mattis Dementia Rating Scale, second edition (MDRS) [@bezdicek2015; @jurica2001], screening of depressive symptoms via Beck Depression Inventory, second edition (BDI-II) [@beck1996; @ciharova2020], and the Penn Parkinson’s Daily Activities Questionnaire (PDAQ) as a measure of instrumental activities of daily living (IADL).The PDAQ is a brief self-report tool consisting of fifteen items selected by Item Response Theory (IRT)-based statistics from a larger pool of items asking patients about the level of diffucilties they experience with cognitively demanding IADL on a five point Likert scale ranging from 0 (“cannot do”) to 4 (“no difficulty”) [@brennan2016; @brennan2016b]. Finally, during the comprehensive pre-surgery assessment for STN DBS patient selection and post-surgery control assessment, motor function was evaluated via MDS-UPDRS III administered by a trained movement disorders neurologist, and psychiatric symptoms were evaluated by a neuropsychiatrist with specialisation in movement disorders to assess risky neuropsychiatric complications.

### Causal assumptions

The causal assumptions of Study 4 are represented in the form of a directed acyclic graph (DAG) depicted in @fig-postop-iadl-dag (panel A). Full description of this graphical model is presented in the source article [@bezdicek2022]. Briefly, the assumptions are that post-surgery responses to PDAQ are determined by their pre-surgery level, time-locked clinical characteristics (MDRS, BDI-II, LEDD), patient- and item-specific characteristics, and DBS itself which is in turn determined by pre-surgery patient's cognitive, affective and medication profiles, all of which are used by clinicians to decide whether to treat the patient with STN DBS. The double-headed arrow between $\text{BDI}_{\text{pre}}$and DBS idicates common cause of these nodes, namely underlying depressive syndrome can both inform the psychiatrist about contraindication to DBS treatment and increase BDI-II score.[^2] The only difference between the model presented in @fig-postop-iadl-dag and the source paper is that here we added further edges from the patient node to DBS node as well as all clinical characteristics on top of its edge to PDAQ. This change is meant to represent that we assume patient-specific time-invariant characteristics (such as disease type or genetic profile) to affect not only PDAQ responses but also all the other variables in our model. Nonetheless, adding edges from the patient node did not change the adjustment sets needed to answer our research questions in any way compared to the source article.

[^2]: Note that the decision for exclusion from STN DBS treatment for current depression is not based on BDI-II (which is adminstered by neuropsychologists in our institution), but by an independent neuropsychiatric evaluation at our institution.

Importantly, to answer *RQ4.2* and *RQ4.3*, we can use the DAG presented in @fig-postop-iadl-dag to use the back-door criterion to derive *adjustment sets*, i.e., the set of covariates that, if conditioned on, allow for interpretation of statistical modelling resuls as causal [@pearl2009; @mcelreath2020; @cinelli2022]. Applying the back-door criterion, we arrive at adjustment sets presented in panels B and C of @fig-postop-iadl-dag for *RQ4.2* and *RQ4.3* respectively. Variables to be adjusted for are represent by squares and the backdoors being closed by this adjustment are depicted as light grey edges in the figure. Although panel C in @fig-postop-iadl-dag do not include item node into the adjustment set, item-level parameters were still included into analysis because they represent competing causes and their inclusion thus will not lead to bias while potentially improving statistical efficiency [see Model 8 in @cinelli2022].

```{r}
#| label: postop-iadl-dag

# prepare labels
lab <- c(
      expression(BDI[post]), expression(BDI[pre]), "DBS",
      expression(DRS[post]), expression(DRS[pre]),
      expression(LEDD[post]), expression(LEDD[pre]),
      expression(PDAQ[post]), expression(PDAQ[pre]),
      "Item", "Patient"
    )

# prepare the DAG
dag <- dagify(
    
    P_post ~ P_pre + pat + it + D_post + B_post + L_post + DBS,
    P_pre ~ pat + it + D_pre + B_pre + L_pre,
    D_post ~ D_pre + B_post + L_post + DBS + pat,
    D_pre ~ B_pre + L_pre + pat,
    B_post ~ B_pre + L_post + DBS + pat,
    B_pre ~ L_pre + pat,
    B_pre ~~ DBS,
    L_post ~ L_pre + DBS + pat,
    L_pre ~ pat,
    DBS ~ P_pre + D_pre + L_pre + pat,
    
    coords = data.frame(
        name = c("P_pre","P_post","pat","it","D_pre","D_post","B_pre","B_post","L_pre","L_post","DBS"),
        x = c(0,2,1,1,-1,3,-1,3,0,2,1),
        y = c(0,0,-1,1,-2,-2,-4,-4,-5,-5,-3)
    )
    
) %>%
    
  tidy_dagitty() %>%
  arrange(name)
  
# prepare the raw DAG
dagfig0 <-
  
  dag %>%
  ggplot( aes( x = x, y = y, xend = xend, yend = yend) ) +
  geom_dag_point( colour = "grey85", size = 20 ) +
  geom_dag_edges( aes( edge_colour = "grey33") ) +
  scale_edge_colour_manual( values = "grey33" ) +
  geom_dag_text( label = lab, parse = T, size = 3.6, colour = "black" ) +
  theme_dag() +
  theme( legend.position = "none" )

# extract adjustment sets for post-surgery change and LEDD_post
adjdag_post <- dag %>% ggdag_adjustment_set( exposure = c("P_pre","DBS"), outcome = "P_post", effect = "direct", type = "minimal" )
adjdag_ledd <- dag %>% ggdag_adjustment_set( exposure = "L_post", outcome = "P_post", effect = "total", type = "minimal" )

# prepare the DAG with adjustment set for direct time/DBS effect
dagfig <-
  
  dag %>%
  mutate( adjusted = "unadjusted", set = "A" ) %>%
  full_join( adjdag_post$data %>% mutate( set = "B" ) ) %>%
  full_join( adjdag_ledd$data %>% filter( set == "{DBS, L_pre, pat}" ) %>% mutate( set = "C" ) ) %>%
    
  ggplot() +
  aes( x = x, y = y, xend = xend, yend = yend, shape = adjusted ) +
  geom_dag_point( colour = "grey85", size = 20 ) +
  geom_dag_edges( aes(edge_colour = adjusted) ) +
  scale_edge_colour_manual( values = c( unadjusted = "black", adjusted = "grey87" ) ) +
  scale_shape_manual( values = c( unadjusted = 19, adjusted = 15 ) ) +
  geom_dag_text( label = rep(lab,3), parse = T, size = 3.6, colour = "black" ) +
  facet_wrap( ~set, nrow = 3 ) +
  theme_dag() +
  theme( legend.position = "none", strip.text.x = element_text(hjust = 0.025, size = 20) )

# pull them together and save it
ggsave(
  plot = last_plot(),
  file = here("figs","iadl_dags.jpg"),
  dpi = 300,
  width = 6,
  height = 14.7
)

```

![Directed acyclic graph representing causal assumptions of relationships between variables of interest in the current study. The panels represent base causal model (A) as well as model after adjusting for covariates to extract estimate of direct post-surgery change (B), and total effect of post-surgery LEDD on post-surgery IADL (C).](figs/iadl_dags.jpg){#fig-postop-iadl-dag}

### Statistical analyses

The data were analyzed using a set of GLMMs with responses to each item of PDAQ as an outcome, patient-specific and item-specific varying predictors, and a structure of group-level parameters dependend on research question. For *RQ4.1*, only the time of assessment (pre- vs post-surgery) was used to predict mean group-level responses (i.e., the "descriptive" model). Following panel B of @fig-postop-iadl-dag, the time of assessment as well as MDRS, BDI-II, LEDD and their interactions with the time of assessment were used to predict group-level responses in model for *RQ4.2* (i.e., the "direct effect" model). Finally, following panel C of @fig-postop-iadl-dag, the time of assessment, LEDD and their interaction were used to predict group-level responses in model for *RQ4.3* (i.e., the "total effect" model). Across all models, the response variable, i.e., the answer to each single PDAQ item on 5-point Likert scale, was modeled using the *ordered-logit* response function [also called *cummulative logit model* or *graded response model* in the literature, @samejima1995; @liddell2018; @bürkner2019; @mcelreath2020]. Student- t priors with zero mean, a scale of 2.5, and 3 degrees of freedom were used for all parameters. Parameters posterior distributions were characterised on the latent logit scale by their medians, 95% HDPIs and *pd*s. Further results were presented as posterior predictions of marginalised response probabilites described by their medians and 95% HDPIs. Time-dependent parameters are denoted $\delta$ and time-independent parameters are denoted $\beta$ throughout.

All GLMMs were fitted using via Stan’s (version `r rstan::stan_version()`) build-in HMC sampler accessed via R version `r with( version, paste(major,minor,sep=".") )` using package “brms” [@bürkner2017; @rsoft; @stan]. Four parallel chains were run each for 2,000 iterations for each GLMM with the first 1,000 iterations being discarded as a warm-up. Convergence was checked numerically by inspection of the $\hat{R}s$ and visually by inspection of trace plots. R packages “tidyverse,” “tidybayes,” and “patchwork” were used in the same roles as for Study 2 [@tidyverse; @tidybayes; @ggplot2; @patchwork]. Full analysis code is available at <https://github.com/josefmana/dbs_postopIADL.git>.

# Results

## Learning curve in verbal and non-verbal memory of patients with Parkinson's disease

```{r}
#| label: lear-curve-init

# raw data
d <-
  read.csv( here("_data","learCUR_data.csv"), sep = "," ) %>%
  mutate( logtrial = log(Trial) ) %>%
  mutate( group = case_when(
    Group0kontroly1PD == 0 ~ "HC (N = 60)",
    Group0kontroly1PD == 1 & MCI_Control == 1 ~ "PD-NC (N = 35)",
    Group0kontroly1PD == 1 & MCI_Control == 2 ~ "PD-MCI (N = 25)"
  ) ) %>%
  mutate( grp = sub(" .*", "", group ) )

# demographics
d0 <- subset( d, Test == "RAVLT" & Trial == 1 )

# number of participants
nums <- sapply( c("HC","PD","PD-NC","PD-MCI"), function(i) nrow( subset( d0, grepl(i,group) ) ) )

```

### Sample characteristics

In total, `r nums[["HC"]]` HC participants and `r nums[["PD"]]` patients with PD were included out of which `r nums[["PD-MCI"]]` were diagnosed with PD-MCI were included into the study. Demographic and clinical characteristics of the sample are presented in @tbl-lear-curve-desc.

```{r}
#| label: tbl-lear-curve-desc
#| tbl-cap: Demographic characteristics of normative and control sample.

d0 %>%
  
  group_by(group) %>%
  summarise(
    `Age (years)` = msd(vek_r), `Education (years)` = msd(vzd_r),
    `Sex (% male)` = rprint( 100 * ( length(pohlavi) - sum(pohlavi) ) / length(pohlavi) ),
    `PD duration (years)` = msd(PD_trvani_r), `LEDD (mg)` = msd(ldopa),
    `MoCA (range 0-30)` = msd(MOCA), `UPDRS III (range 0-132)` = msd(updrs_III_on)
  ) %>%
    
  column_to_rownames("group") %>%
  t() %>%
  as.data.frame() %>%
  mutate( across( everything(), ~ ifelse( grepl("NaN",.x), "-", .x ) ) ) %>%
  relocate( `PD-MCI (N = 25)`, .after = `PD-NC (N = 35)` ) %>%
  
  gt( rownames_to_stub = T ) %>%
  cols_align( align = "center", columns = -1 ) %>%
  tab_source_note(
    source_note = "BDI-II: Beck Depression Rating Scale, second edition; HC: healthy control group; LEDD: levodopa equivalent daily dose; MoCA: Montreal Cognitive Assessment; N: number of observations; PD: Parkinson's Disease; PD-MCI: Mild Cognitive Impairment in Parkinson's Disease; PD-NC: Normal Cognition in Parkinson's Disease; UPDRS III: Unified Parkinson’s Disease Rating Scale, motor part; all values represent mean (standard deviation) for continuous and percentages for nominal variables."
  )

```

### Learning curve analysis

```{r}
#| label: lear-curve-modeling

# fit the models
m <-
  
  lapply(
    
    setNames( unique(d$Test), unique(d$Test) ),
    function(i)
      
      brm(
        formula = Score ~ 1 + grp * logtrial + (1 + logtrial | id),
        family = gaussian(), prior = NULL, data = subset( d, Test == i ),
        seed = s, chains = ch, iter = it, warmup = wu,
        file = here( "mods", paste0("learCUR_",i,".rds") ),
        save_model = here( "mods", paste0("learCUR_",i,".stan") )
      )
    
  )

# diagnostics
rhatmax <- ubound( max( sapply( names(m), function(i) max( rhat(m[[i]]) ) ) ) )

# prepare posterior summaries for plotting
post_sum <-
  
  lapply(
    
    names(m),
    function(i) {
      
      # data
      d_seq <-
        expand.grid( Trial = 1:ifelse(i == "BVMT", 3, 5), grp = unique(d$grp), id = "sub000" ) %>%
        mutate( logtrial = log(Trial) )
      
      # posteriors
      post <-
        
        lapply(
          
          setNames( c("group","pop"), c("group","pop") ),
          function(j)
            
            add_epred_draws( object = m[[i]], newdata = d_seq , allow_new_levels = T, if ( j == "group" ) { re_formula = NA }, seed = 87542 ) %>%
            ungroup() %>%
            select( Trial, grp, .draw, .epred ) %>%
            mutate( pred = case_when(
              .epred > 15 & i == "RAVLT" ~ 15,
              .epred > 12 & i == "BVMT" ~ 12,
              .epred < 0 ~ 0,
              .default = .epred
            ) ) %>%
            group_by( grp, Trial ) %>%
            summarise( md = median(pred), hdi_low = hdci(pred)[1], hdi_hig = hdci(pred)[2] ) %>%
            mutate( level = j, Test = i )
          
        )
      
      # add predictions
      post$pred <-
        
        add_predicted_draws( object = m[[i]], newdata = d_seq , allow_new_levels = T, seed = 87542 ) %>%
        ungroup() %>%
        select( Trial, grp, .draw, .prediction ) %>%
        mutate( pred = case_when(
          .prediction > 15 & i == "RAVLT" ~ 15,
          .prediction > 12 & i == "BVMT" ~ 12,
          .prediction < 0 ~ 0,
          .default = .prediction
        ) ) %>%
        group_by( grp, Trial ) %>%
        summarise( md = median(pred), hdi_low = hdci(pred)[1], hdi_hig = hdci(pred)[2] ) %>%
        mutate( level = "pred", Test = i )
      
      # prepare posterior summary
      post <-
        do.call( rbind.data.frame, post ) %>%
        pivot_wider( names_from = level, values_from = c("md","hdi_low","hdi_hig") ) %>%
        rename( "Score" = "md_group" )
      
      # return the results
      return(post)
      
    }

  ) %>%
  
  do.call( rbind.data.frame, . ) %>%
  ungroup() %>%
  mutate( `Group: ` = factor( grp, levels = c("HC","PD-NC","PD-MCI"), ordered = T ) )

# plot it
f_learCUR <-
  
  # prepare data
  d %>%
  mutate( `Group: ` = factor( grp, levels = c("HC","PD-NC","PD-MCI"), ordered = T ) ) %>%
  
  # start plotting
  ggplot() +
  aes( x = Trial, y = Score, colour = `Group: ` ) +
  geom_jitter( width = 0.2, height = 0, alpha = .33 ) +
  
  # learning curves
  geom_line( data = post_sum, aes( x = Trial, y = Score, group = `Group: ` ), linewidth = 1.5, position = position_dodge(width = .3 ) ) +
  
  # predictive intervals
  geom_linerange( data = post_sum, aes( x = Trial, y = Score, group = `Group: `, ymin = hdi_low_group, ymax = hdi_hig_group ), size = 3, position = position_dodge(width = .3 ) ) +
  geom_linerange( data = post_sum, aes( x = Trial, y = Score, group = `Group: `, ymin = hdi_low_pop, ymax = hdi_hig_pop ), size = 1.2, position = position_dodge(width = .3 ) ) +
  geom_errorbar( data = post_sum, aes( x = Trial, y = Score, group = `Group: `, ymin = hdi_low_pred, ymax = hdi_hig_pred ), size = .5, width = .3, position = position_dodge(width = .3 ) ) +
  
  # model expactations
  geom_point( data = post_sum, aes( x = Trial, y = Score, group = `Group: ` ), size = 4, position = position_dodge(width = .3 ), colour = "black" ) +
  
  # make final adjustments
  facet_wrap( ~ Test, ncol = 2, scales = "free", labeller = as_labeller( c( BVMT = "BVMT-R", RAVLT = "RAVLT" ) ) ) +
  scale_y_continuous( breaks = seq( 0, 15, 3) ) +
  scale_x_continuous( breaks = 1:5 ) +
  scale_colour_manual( values = c("#54A021","#E76618","#C42F1A") ) +
  theme_bw( base_size = 22 ) +
  theme( legend.position = "bottom" )

# save it
ggsave( plot = f_learCUR, file = here("figs","lear_curves.jpg"), dpi = 300, width = 14, height = 7 )

```

Both models converged to a stationary posterior distribution within specified number of iterations ($\hat{R}$s \< `r rhatmax`). The data as well as model fits with uncertainty estimates on group-level, group- and participant-level, and full model with added measurement error are presented in @fig-lear-curve. Inference statistics related to research questions of Study 1 are presented in @tbl-lear-curve. In both, BVMT-R and RAVLT, there was evidence of main effect existence (*pd* \> .975) that is practically significant (\< 2.5% in ROPE) implying that patients with PD-MCI experience overall memory deficit in both visuospatial and verbal modalities. Upon closer look, our data and models imply that this deficit is due to *retention* impairment with relatively unimpaired *learning curve* in visuospatial modality while the reverse is true for the verbal domain whereby PD-MCI patients show only slight impairment in *retention*, however, there is a clear *learning curve* impairment present (@tbl-lear-curve).

```{r}
#| label: tbl-lear-curve
#| tbl-cap: "Analysis of visuospatial and verbal learning curves"

t_post_learCUR <-
  
  lapply(
    
    names(m),
    function(i) {
      
      rope <- case_when( i == "RAVLT" ~ c(-0.223, 0.223), i == "BVMT" ~ c(-0.210, 0.210) ) # ROPE
      
      contr <- list(
        main = pairs( emmeans( m[[i]], ~ grp ) ), # main effect/recall
      simple = pairs( ref_grid( m[[i]], at = list(logtrial = 0, cov.reduce = grp ~ logtrial) ) ), # simple effect/retention
      inter = contrast( emtrends( m[[i]], ~ grp | logtrial, var = "logtrial" ), interaction = "pairwise") # interaction/learning curve
      )
      
      res <-
        lapply(
          names(contr),
          function(j)
            describe_posterior(
              contr[[j]], centrality = "median", dispersion = F, ci = .95, ci_method = "hdi",
              test = c("p_direction", "rope"), rope_range = rope, rope_ci = 1
            ) %>%
            as.data.frame() %>%
            mutate( test = i, effect = j, .before = 1 )
        ) %>%
        do.call( rbind.data.frame, . )
      
    }

  ) %>%
  
  do.call( rbind.data.frame, . ) %>%
  mutate(
    effect = case_when(
      effect == "main" ~ "Recall (Main effect)",
      effect == "simple" ~ "Retention (Simple effect on the first trial)",
      effect == "inter" ~ "Learning curve (Interaction effect)"
    ),
    Contrast = case_when(
      grepl("HC",Parameter) & grepl("NC",Parameter) ~ "HC-minus-(PD-NC)",
      grepl("HC",Parameter) & grepl("MCI",Parameter) ~ "HC-minus-(PD-MCI)",
      grepl("NC",Parameter) & grepl("NC",Parameter) ~ "(PD-MCI)-minus-(PD-NC)"
    ),
    Median = rprint(Median,2),
    hdpi = paste0( "[", rprint(CI_low,2), ", ", rprint(CI_high,2), "]" ),
    pd = zerolead( rprint(pd,3) ),
    roperc = ifelse( ROPE_Percentage < .01, "< 1", rprint( 100 * ROPE_Percentage, 2 ) )
  ) %>%
  
  select( test, effect, Contrast, Median, hdpi, pd, roperc ) %>%
  pivot_wider( names_from = test, values_from = c("Median","hdpi",pd,"roperc") ) %>%
  relocate( hdpi_BVMT, .before = Median_RAVLT ) %>%
  relocate( pd_BVMT, .before = Median_RAVLT ) %>%
  relocate( roperc_BVMT, .before = Median_RAVLT )

# write it
write.table( t_post_learCUR, file = here("tabs","lear_curves.csv"), sep = ";", row.names = F, quote = F )

# sho it
t_post_learCUR %>%
  
  gt( groupname_col = "effect", rowname_col = "Contrast" ) %>%
  cols_align( columns = -1, align = "center" ) %>%
  cols_align( columns = "Contrast", align = "left" ) %>%
  tab_spanner( columns = ends_with("BVMT"), label = "BVMT-R", gather = F ) %>%
  tab_spanner( columns = ends_with("RAVLT"), label = "RAVLT", gather = F ) %>%
    
  cols_label(
    starts_with("Median") ~ "Median",
    starts_with("hdpi") ~ "95% HDPI",
    starts_with("pd") ~ "pd",
    starts_with("roperc") ~ "% in ROPE"
  ) %>%
    
  tab_footnote( locations = cells_column_labels( starts_with("rope") ), footnote = "region of practical equivalence was set to one-tenth of normative standard deviation for a median trial, i.e., −0.210–0.210 for BVMT-R and −0.223–0.223 for RAVLT" ) %>%
  
  opt_footnote_marks(marks = "letters") %>%
    
  tab_source_note( source_note = "BVMT-R: Brief Visuospatial Memory Test - Revised; HC: healthy adult control participants; HDPI: highest density posterior interval; pd: probability of direction; PD-MCI: Parkinson’s disease patients with mild cognitive impairment; PD-NC: Parkinson’s disease patients without mild cognitive impairment; RAVLT: Rey Auditory Visual Learning Test; ROPE: region of practical equivalence; comparisons in bold can be regarded as evidence of the existence of an effect (pd >.975)." )

```

![Visuospatial and verbal learning curves of control participants and Parkinson’s Disease patients. Lines and black points represent median posterior predictions with 95% highest density posterior intervals from group-level predictions (thick vertical lines), group- and participant-level predictions (thin vertical lines), and full model with added mesurement error (error bars). Coloured points represent observed data-points jittered horizontally for visualisation purposes; BVMT-R: Brief Visuospatial Memory Test – Revised; RAVLT: Rey Auditory Visual Learning Test; HC: healthy controls; PD-NC: Parkinson’s Disease with normal cognition; PD-MCI: Parkinson’s Disease with Mild Cognitive Impairment.](figs/lear_curves.jpg){#fig-lear-curve}

## Preoperative Cognitive Profile Predictive of Cognitive Decline after Subthalamic Deep Brain Stimulation in Parkinson's Disease

### Sample characteristics

Baseline demographic and clinical and neuropsychological characteristics as well as stimulation parameters of the sample are presented in @tbl-cog-pred-demo. Mean duration of a follow-up after the surgery was `r itstats[['fudur']][['mean']]` years (SD = `r itstats[['fudur']][['sd']]`, median = `r itstats[['fudur']][['median']]`, range = `r itstats[['fudur']][['min']]`–`r itstats[['fudur']][['max']]`) with a median number of `r itstats[['nass']][['median']]` assessments per patient (range = `r itstats[['nass']][['min']]`–`r itstats[['nass']][['max']]`) (see also @fig-cog-pred-dist).

```{r}
#| label: tbl-cog-pred-demo
#| tbl-cap: Clinical and neuropsychological characteristics of the sample of included patients.

read.csv( here("tabs","demo_clinchar.csv"), sep = "," ) %>%
  
  full_join(
    read.csv( here("tabs","demo_basepsych.csv"), sep = "," ) %>%
      rename( "Characteristic" = "Test" ) %>%
      add_column( Type = "Pre-surgery cognitive profile", .after = "Characteristic" ) %>%
      mutate_if( is.numeric, as.character )
  ) %>%
    
  gt( rowname_col = "Characteristic", groupname_col = "Type" ) %>%
  cols_align( align = "center", columns = -1 ) %>%
  cols_label( Min.Max ~ "Min-Max") %>%
  
  tab_footnote(
    footnote = "Each measurement of each electrode considered independently. For stimulation parameters, column N indicate number of patients with current/voltage mode of stimulation.",
    locations = cells_row_groups( groups = "Stimulation parameters" )
  ) %>%
  
  opt_footnote_marks(marks = "letters") %>%
  
  tab_source_note(
    source_note = "N: number of observations; Md: median; M: mean; SD: standard deviation; MDS-UPDRS III: Movement Disorder Society Unified Parkinson’s Disease Rating Scale, motor part; LEDD: levodopa equivalent daily dose; Levodopa test: a percentage change of the MDS-UPDRS III score from medication OFF to medication ON state during the levodopa test as described in the main text; V: Volts; mA: milliampere; μs: microseconds; Hz: Hertz; MDRS: Dementia Rating Scale, second edition; BDI-II: Beck Depression Rating Scale, second edition; STAI-X1: State-Trait Anxiety Inventory, the state version; STAI-X2: State-Trait Anxiety Inventory, the trait version; TMT-A: Trail Making Test, part A; TMT-B: Trail Making Test, part B; DS-F: Digit Span forward; DS-B: Digit Span backward; LNS: letter-number sequencing; SS-F: Spatial Span forward; SS-B: Spatial Span backward; TOL: Tower of London task; PST-D: Prague Stroop Test, dot color naming; PST-W: Prague Stroop Test, word color naming; PST-C: Prague Stroop Test, interference condition; COWAT: Controlled Oral Word Association Test; CFT: category fluency test; Sim.: Similarities; RAVLT-IR: Rey Auditory Verbal Learning Test, immediate recall; RAVLT-B: Rey Auditory Verbal Learning Test, recall of the interference set; RAVLT-DR: Rey Auditory Verbal Learning Test, delayed recall; RAVLT- Rec50: Rey Auditory Verbal Learning Test, delayed recognition from 50 items (15 correct answers + 35 distractors); RAVLT-Rec15: Rey Auditory Verbal Learning Test, delayed recognition, number of correctly identified from 15 items; FP-IR: Family Pictures, immediate recall; FP-DR: Family Pictures, delayed recall; Secs: seconds; Total words: word count in two minutes (one minute per each letter P and K); words/min.: word count in one minute time limit."
  )

```

![Distribution of assessments. Distribution of (A) follow-up years and (B) number of assessments per patient for N = 126 patients. Negative values on horizontal axis in (A) represent pre-surgery assessments, number of assessments in (B) includes one pre-surgery and various number of post-surgery assessments.](figs/demo_assessments.jpg){#fig-cog-pred-dist}

### Pre-surgery cognitive profile

```{r}
#| label: cog-pred-factanal

fa <- readRDS( here("mods","cogPRED_factanal.rds") )

# list order of tests used for the plot
o <- c("PST-W","PST-D","PST-C","TOL","COWAT","CFT","TMT-B","TMT-A","RAVLT-IR","RAVLT-DR","RAVLT-Rec50","RAVLT-Rec15",
       "DS-F","DS-B","Sim.","LNS","RAVLT-B","FP-IR","FP-DR","STAI-X1","STAI-X2","SS-F","SS-B")

# variance accounted for
vaccount <- 
  
  sapply(
    
    c("mean","sd"), # loop through summary stats of interest
    function(i)
      
      ( # extract all total cumulative variability accounted for by 7-factor model & calculate summaries
        do.call(
          i,
          list( sapply( 1:length(fa), function(j) max( fa$efa[[j]][[5]]$Vaccounted[ "Cumulative Var", ] ) ) )
          ) * 100 # make it percentages
        ) %>%
      
      rprint(1) %>%
      paste0(.," %")
        
  )

# prepare the figure
fig_factanal <-
  
  lapply(
    1:100,
    function(i)
      loadings(fa$efa[[i]][[5]]) %>%
      as.data.frame() %>%
      rownames_to_column("test") %>%
      pivot_longer( cols = -test, names_to = "factor", values_to = "load" )
  ) %>%
  
  do.call( rbind.data.frame, . ) %>%
  mutate( load = ifelse( grepl("pst|tmt",test), -load, load ) ) %>%
  mutate( test = sapply( 1:nrow(.), function(i) v[ test[i], "name" ] ) ) %>%
  mutate( test = factor( test, levels = rev(o), ordered = T ) ) %>%
    
  ggplot() +
  aes( x = load, y = test, fill = after_stat( abs(x) > .3  ) ) +
  geom_density_ridges_gradient( scale = 1.5, rel_min_height = 0.001 ) +
  scale_fill_manual( values = c("grey93","#E69F00") ) +
  labs( x = "Factor loading", y= NULL ) +
  theme_bw( base_size = 14 ) +
  theme( legend.position = "none" ) +
  facet_wrap(
    ~ factor( factor, levels = colnames( loadings(fa$efa[[1]][[5]]) ) ),
    nrow = 1,
    labeller = as_labeller(
      c( exec_fun = "EF/Att.", epis_mem = "EM", verb_wm = "VWM", visp_mem = "VM", set_shift = "SS", anxiety = "An.", visp_wm = "VWM")
    )
  )

# save it
ggsave( plot = fig_factanal, file = here("figs","cogpred_factnal.jpg"), dpi = 300, width = 11.7, height = 10.32  )

```

In the exploratory factor analyses, we examined from three up to eight factor solutions for pre-surgery cognitive profile. According to TLI and RMSEA, there was a clear improvement when increasing the number from six to seven factors whereby good TLI (i.e., TLI \> .9) increased from 76 to 97, and good RMSEA (i.e., RMSEA \< .05) increased from 96 to 99 out of 100 imputed data sets. Moreover, the seven factor solution showed the most consistency of factors across imputations. Finally, even though the eight factor solution had better fit statistics than the seven factor solution, it resulted in factors loaded on substantially (i.e., with a factor loading above 0.3) by only a single cognitive test score which impedes theoretical interpretation of such factors. Consequently, the seven factor solution was retained for further analyses. Summary of factor loadings across imputations is presented in @fig-cog-pred-factanal. On average, the seven factors accounted for a total of `r vaccount['mean']` of variance (SD = `r vaccount['sd']`) and corresponded to seven cognitive functions: 1) executive functions/attention (EF/Att.) was loaded on primarily by PST tasks, TMT tasks, verbal fluency tests and TOL, 2) episodic memory (EM) was loaded on primarily by indexes of RAVLT except for the recall of interference list (RAVLT-B), 3) verbal working memory (VWM) was loaded on primarily by Digit Span tasks, LNS and Similarities, 4) visuospatial memory (VM) was loaded on primarily by indexes of the Family Pictures test, 5) set shifting (SS) was loaded on primarily by TMT tasks and RAVLT-B, 6) anxiety (An.) was loaded on primarily by STAI, and 7) spatial working memory (SWM) was loaded on primarily by Spatial Span tasks.

![Factor loadings for the selected exploratory factor analysis represented as density plots across 100 imputations.](figs/cogpred_factnal.jpg){#fig-cog-pred-factanal}

### Post-surgery cognitive change description

```{r}
#| label: cog-pred-desc

m0 <- readRDS( here("mods","cogPRED_linear.rds") ) # model
rhatmax <- ubound( max( rhat(m0) ) ) # max Rhat

scl <- read.csv( here("tabs","cogpred_scaling.csv"), sep = "," ) %>% column_to_rownames("variable")

# get pre-surgery and slope predictions
tcontr <-
  
  lapply(
    
    c("group","pop"),
    function(i)
      
      # prepare data
      data.frame( id = "sub000", time_y = c( -scl["Time","central_tendency"] , -scl["Time","central_tendency"] + 1) ) %>%
      mutate( time = time_y + scl["Time","central_tendency"] ) %>%
      
      # extract predictions
      add_epred_draws(
        object = m0,
        newdata = . ,
        allow_new_levels = T,
        if ( i == "group" ) { re_formula = NA },
        seed = 87542
      ) %>%
      
      # post-process
      mutate( pred = scl["DRS","central_tendency"] + scl["DRS","standard_deviation"] * .epred ) %>%
      mutate( pred = case_when( pred > 144 ~ 144, pred < 0 ~ 0, .default = pred) ) %>%
      ungroup() %>%
      select( id, time, .draw, pred ) %>%
      pivot_wider( names_from = time, names_prefix = "Y", values_from = pred ) %>%
      mutate( slope = Y1 - Y0) %>%
      pivot_longer( cols = -c("id",".draw"), names_to = "contrast" ) %>%
      group_by(contrast) %>%
      summarise( md = median(value), hdi_low = hdci(value,.width=.95)[1], hdi_hig = hdci(value,.width=.95)[2] ) %>%
      mutate( level = i, .before = 1 )
    
  )

# extract predictive contrast of one year post-minus-pre assessments
tcontr$pred <-
  
  data.frame( id = "sub000", time_y = c( -scl["Time","central_tendency"] , -scl["Time","central_tendency"] + 1) ) %>%
  mutate( time = time_y + scl["Time","central_tendency"] ) %>%
  add_predicted_draws( object = m0, newdata = . , allow_new_levels = T, seed = 87542 ) %>%
  mutate( pred = scl["DRS","central_tendency"] + scl["DRS","standard_deviation"] * .prediction ) %>%
  mutate( pred = case_when( pred > 144 ~ 144, pred < 0 ~ 0, .default = pred ) ) %>%
  ungroup() %>%
  select( id, time, .draw, pred ) %>%
  pivot_wider( names_from = time, names_prefix = "Y", values_from = pred ) %>%
  mutate( slope = Y1 - Y0) %>%
  pivot_longer( cols = -c("id",".draw"), names_to = "contrast" ) %>%
  group_by(contrast) %>%
  summarise( md = median(value), hdi_low = hdci(value,.width=.95)[1], hdi_hig = hdci(value,.width=.95)[2] ) %>%
  mutate( level = "pred", .before = 1 )

# put it together
tcontr <-
  
  tcontr %>%
  do.call( rbind.data.frame, . ) %>%
  mutate(
    median = rprint(md,2),
    absmedian = rprint(abs(md),2),
    hdpi = paste0( "[",rprint(hdi_low,2),", ",rprint(hdi_hig,2),"]" )
  ) %>%
  select( level, contrast, median, absmedian, hdpi )

```

The descriptive longitudinal GLMM converged to a stationary posterior distribution within specified number of iterations ($\hat{R}$s \< `r rhatmax`). On the group-level, there was an average post-surgery decline of `r with( tcontr, absmedian[ level == 'group' & contrast == 'slope' ] )` MDRS points/year (95% HDPI `r with( tcontr, hdpi[ level == 'group' & contrast == 'slope' ] )`) from an average pre-surgery MDRS performance of `r with( tcontr, absmedian[ level == 'group' & contrast == 'Y0' ] )` out of 144 points (95% HDPI `r with( tcontr, hdpi[ level == 'group' & contrast == 'Y0' ] )`). After accounting for not only group-level variability but also patient-level variability for generalisation of the inference of the true score change to the CAPSIT-based population of STN DBS treated patients with PD, the estimate reached annual decline of `r with( tcontr, absmedian[ level == 'pop' & contrast == 'slope' ] )` MDRS points/year (95% HDPI `r with( tcontr, hdpi[ level == 'pop' & contrast == 'slope' ] )`). Finally, when changing the level of analysis from inference to prediction by adding measurement error to the estimates, expected annual post-surgery cognitive decline was `r with( tcontr, absmedian[ level == 'pred' & contrast == 'slope' ] )` MDRS points/year (95% HDPI `r with( tcontr, hdpi[ level == 'pred' & contrast == 'slope' ] )`). This three-level estimate of the rate of post-surgery cognitive decline is further presented in @fig-cog-pred-desc and @tbl-cog-pred-desc as expected median and 90% ETIs change scores of MDRS score after STN DBS surgery.

```{r}
#| label: tbl-cog-pred-desc
#| tbl-cap: "Posterior predictions of cognitive change after STN DBS surgery."

read.csv( here("tabs","cogpred_contrasts.csv"), sep = ";" ) %>%
  
  rename(
    "Group-level" = "Group.level.parameters",
    "Population-level" = "Group....Patient.level.parameters",
    "Prediction" = "Full.Model"
  ) %>%
  
  gt( groupname_col = "block" ) %>%
  cols_align( -1, align = "center" ) %>%
  cols_label( Contrast ~ "" ) %>%
  
  tab_spanner( label = "Inference", columns = ends_with("-level"), gather = F ) %>%
  
  tab_footnote(
    locations = cells_column_spanners("Inference"),
    footnote = "The columns represent estimation of true score changes before measurement error is added."
  ) %>%
    
  tab_footnote(
    locations = cells_column_labels("Group-level"),
    footnote = md("Contrasts for the sample version *RQ1* estimand predicted by $\\mu_i$ ~ $\\alpha$ + $\\delta_{time}$*time~i~*")
  ) %>%
  
  tab_footnote(
    locations = cells_column_labels("Population-level"),
    footnote = md("Contrasts for the population version *RQ1* estimand predicted by $\\mu_i$ ~ $\\alpha$ + $\\delta_{time}$*time~i~* + $\\alpha_{id[i]}$ + $\\delta_{id[i]}$*time~i~*")
  ) %>%
  
  tab_footnote(
    locations = cells_column_labels("Prediction"),
    footnote = md("Contrasts for model's prediction of the raw score sampled from *t(* $\\vartheta$, $\\mu_i$, $\\sigma$*)*")
  ) %>%
  
  tab_footnote(
    locations = cells_row_groups( groups = "Yearly decline" ),
    footnote = "The rows represents expactation of patients' performance at pre-surgery assessment, i.e., 0.3 years before surgery (Intercept), and expected annual Dementia Rating Scale decline (Slope)."
  ) %>%
  
  opt_footnote_marks(marks = "letters") %>%
  
  tab_source_note(
    source_note = "Yi: assessment i years post-surgery; values represent posterior prediction median [90% equal tailed interval (ETI)]; we used 90% ETI instead of the 95% highest density posterior predictive intervals (HDPIs) used elsewhere in the article because 90% ETI can be interpreted such that there is 5% probability of observing value smaller than its lower bound and 5% probability of observing value bigger than its upper bound which may not hold for PPIs; all values were calculated by first generating predcitions from the linear desciptive models using parameters specified above and then censoring values above 144 or below 0 before calculating medians and 90% ETIs."
  )

```

![Post-surgery change scores estimates from the descriptive longitudinal model of Mattis Dementia Rating Scale (MDRS) change in patients with Parkinson's disease treated by subthalamic deep brain stimulation. The plot represents estimated change in MDRS with respect to pre-surgery assessment (ordinate) at different time lags from five months to five years post-surgery (abscissa) on three levevls: point estimate (black line), inference at group- (dark pink) and population-level (medium pink), and prediction with added measurement error (light pink).](figs/cogpred_contrasts.jpg){#fig-cog-pred-desc}

### Post-surgery cognitive change prediction

```{r}
#| label: cog-pred-mods

# chains convergence
rhatmax <-
  
  sapply(
    c("factors","tests"),
    function(i)
      max( readRDS( here( "mods", paste0("cogPRED_lasso",i,".rds") ) )$rhats, na.rm = T )
  ) %>%
  max() %>%
  ubound(2)

# tables
tbl_cogpred <-
  
  lapply(
    
    setNames( c("factors","tests"), c("factors","tests") ),
    function(i)
      
      read.csv( here( "tabs", paste0("cogpred_",i,"post.csv") ), sep = ";" ) %>%
      rename( "Median" = "b", "95% HDPI" = "X95..PPI", "pd" = "pdir" ) %>%
      mutate( pd = zerolead( rprint( ifelse( pd > .5, pd, 1- pd), 3 ) ) ) %>%
      gt( groupname_col = "Group" ) %>%
      cols_align( columns = -1, align = "center" ) %>%
      text_transform(
        locations = cells_row_groups(),
        fn = function(x) case_when(
          x == "alpha" ~ "Global intercept (α)",
          x == "beta" ~ "Baseline correlates (β)",
          x == "delta" ~ "Time-dependent parameters (𝛿)"
        )
      )
    
  )

# prepare a table for in-text reporting
intext_tbl <-
  tbl_cogpred$factors %>%
  as.data.frame() %>%
  column_to_rownames("Parameter")

```

Both predictive longitudinal GLMMs converged to a stationary posterior distribution within specified number of iterations across all imputed data sets ($\hat{R}$s \< `r rhatmax`). Group-level model parameters are presented in @tbl-cog-pred-tests and @tbl-cog-pred-factors for the "test scores" and "factor scores" models respectively. Cross-sectionally, pre-surgery MDRS performance was reliably (i.e., with high posterior probability, compare to @makowski2019) predicted by the verbal working memory factor score ($\beta_{VWM}$ = `r intext_tbl['VWM','Median']`, 95% HDPI `r intext_tbl['VWM','95% HDPI']`, *pd* = `r intext_tbl['VWM','pd']`) and to a lesser extent by the set shifting factor score ($\beta_{SS}$ = `r intext_tbl['SS','Median']`, 95% HDPI `r intext_tbl['SS','95% HDPI']`, *pd* = `r intext_tbl['SS','pd']`). There was no cognitive test that would by itself statistically clearly indicate pre-surgery MDRS impairment. Post-surgery cognitive decline was associated with pre-surgery executive functions/attention score with high posterior probability ($\delta_{EF/Att.}$ = `r intext_tbl['EF/Att. × Time','Median']`, 95% HDPI `r intext_tbl['EF/Att. × Time','95% HDPI']`, *pd* = `r intext_tbl['EF/Att. × Time','pd']`). @fig-cog-pred-pred illustrates how the rate of post-surgery cognitive decline relates to pre-surgery cognitive profile operationalised by cognitive factor scores derived from EFA. Patients with pre-surgery EF/Att. factor scores high relatively to the rest of the sample (top-right panel) showed almost no to small long-term decline in MDRS after surgery compared. to patients with EF/Att. factor scores low relatively to the rest of the sample (top-left panels). There was no cognitive test that would by itself statistically clearly indicate post-surgery MDRS decline.

```{r}
#| label: tbl-cog-pred-tests
#| tbl-cap: Summary of group-level parameters' posteriors from the “test scores” predictive generalized linear mixed model.

# add footnotes
tbl_cogpred$tests %>%

  tab_footnote( footnote = "All cognitive predictors were scaled such that negative values mean negative effect of pre-surgery deficit on longitudinal cognitive trajectory." ) %>%
  opt_footnote_marks(marks = "letters") %>%
  tab_source_note( source_note = "Median: parameter value point estimate (posterior median); HDPI: highest density posterior probability interval; pd: probability of direction; ×: statistical interaction term; STAI-X1: State-Trait Anxiety Inventory, the state version; STAI-X2: State-Trait Anxiety Inventory, the trait version; TMT-A: Trail Making Test, part A; TMT-B: Trail Making Test, part B; DS-F: Digit Span forward; DS-B: Digit Span backward; LNS: letter-number sequencing; SS-F: Spatial Span forward; SS-B: Spatial Span backward; TOL: Tower of London task; PST-D: Prague Stroop Test, dot color naming; PST-W: Prague Stroop Test, word color naming; PST-C: Prague Stroop Test, interference condition; COWAT: Controlled Oral Word Association Test; CFT: category fluency test; Sim.: Similarities; RAVLT-IR: Rey Auditory Verbal Learning Test, immediate recall; RAVLT-B: Rey Auditory Verbal Learning Test, recall of the interference set; RAVLT-DR: Rey Auditory Verbal Learning Test, delayed recall; RAVLT-Rec50: Rey Auditory Verbal Learning Test, delayed recognition from 50 items (15 correct answers + 35 distractors); RAVLT-Rec15: Rey Auditory Verbal Learning Test, delayed recognition, number of correctly identified from 15 items; FP-IR: Family Pictures, immediate recall; FP-DR: Family Pictures, delayed recall; comparisons in bold can be regarded as evidence of the existence of an effect (pd >.975)." )

```

```{r}
#| label: tbl-cog-pred-factors
#| tbl-cap: Summary of group-level parameters' posteriors from the “factor scores” predictive generalized linear mixed model.

# add footnotes
tbl_cogpred$factors %>%

  tab_footnote( footnote = "All cognitive predictors were scaled such that negative values mean negative effect of pre-surgery deficit on longitudinal cognitive trajectory." ) %>%
  opt_footnote_marks(marks = "letters") %>%
  tab_source_note( source_note = "Median: parameter value point estimate (posterior median); HDPI: highest density posterior probability interval; pd: probability of direction; ×: statistical interaction term; EF/Att.: Executive functions/Attention; EM: Episodic memory; VWM: Verbal working memory; VM: Visuospatial memory; SS: Set shifting; An: Anxiety; SWM: Spatial working memory; comparisons in bold can be regarded as evidence of the existence of an effect (pd >.975)." )

```

![Longitudinal post-surgery cognitive trajectories in patients with Parkinson's disease treated with subthalamic deep brain stimulation stratified by pre-surgery cognitive profile. The sample was repeatedly divided to pentiles (columns) ranging from the lowest (left) to the highest (right) performers based on each pre-surgery cognitive factor (rows) (in the case of Anxiety, patients to the left reported more pre-surgery anxiety than patients to the right). Subsequently, model predictions of Mattis Dementia Rating Scale (MDRS, ordinate) at different post-surgery time lags (abscissa) for each pentile were calculated on three levels of inference related to the MDRS true score: point estimate (dark line), group-level uncertainty estimate (medium saturation ribbon), and population-level uncertainty (light ribbon). The horizontal dotted line is placed at 139 MDRS points which represent mild cognitive impairment cut-off with optimal specificity and sensitivity according to the Czech normative study.](figs/cogpred_stratified.jpg){#fig-cog-pred-pred}

## Structural and microstructural predictors of cognitive decline in deep brain stimulation of subthalamic nucleus in Parkinson’s disease

### Sample characteristics

Clinical, demographic, and stimulation-related characteristics of the sample as well as statistical comparison of these characteristics in CS versus CD groups is presented in @tbl-mri-pred-desc. Pre-surgery, the only statistically significant difference regarded patients age whereby the CD group of patients were on average older by circa ten years. No statistically significant pre-surgery difference was detected in either distribution of sex and PD-MCI or average disease duration and MDRS scores between the groups. On the other hand, although there was not a statistically significant difference in follow-up years, statistically significant differences between CS and CD groups were detected in post-surgery MDRS scores and PD-MCI distribution (with CD group having lower average MDRS score and higher PD-MCI prevalence). In none of the DBS-related parameters there was a statistically significant difference between CS and CD patients detected. Nonetheless, CD patients had on average lower total electrical energy delivered to the STN DBS system.

```{r}
#| label: tbl-mri-pred-desc
#| tbl-cap: Clinical, demograhic and stimulation-related characteristics of the sample of included patients. 

read.csv( here("tabs","mripred_desc.csv"), sep = "," ) %>%

  gt( groupname_col = "block" ) %>%
  cols_align( align = "center", columns = -1 ) %>%
  cols_label(
    var ~ "",
    CS52 ~ "Cognitively stable (N = 52)",
    CD20 ~ "Cognitively declining (N = 20)",
    q ~ "q-value"
  ) %>%
    
  tab_footnote(
    locations = cells_row_groups("DBS-related information"),
    footnote = "Available for all but one cognitively stable patient and all cognitively declining patients."
  ) %>%
    
  tab_footnote(
    locations = cells_body( columns = var, rows = c(12:17) ),
    footnote = "Reported values are bilateral averages."
  ) %>%
  
  opt_footnote_marks(marks = "letters") %>%
  
  text_transform(
    locations = cells_body( columns = var ),
    fn = function(x) sub( "mm3", "mm<sup>3</sup>", x )
  ) %>%
  
  tab_source_note(
    source_note = "DBS: deep brain stimulation; MDRS: Dementia Rating Scale, second edition; ΔMDRS: average annual change in Dementia Rating Scale, second edition score; Hz: Hertz; kΩ: kiloohm; mA: milliampere; MCI: mild cognitive impairment; μs: microseconds; μW: microwatts; PD: Parkinson's disease; PD-MCI: Mild cognitive impairment in Parkinson's disease; q-value: raw p-value after adjusting for 5% false discovery rate (FDR) level; STN: subthalamic nucleus; V: Volts; values are presented as in-sample mean ± standarad deviation for continuous variables, percentages for demographic categorical variables and frequencies for DBS-related categorical variables."
  )
  
```

### Magnetic resonance profile of patients experiencing cognitive decline

In the cross-sectional analysis of pre-surgery MDRS, no macrostructural, FA or MD correlate of current pre-surgery cognitive performance was detected. On the other hand, the comparison of longitudinally defined CS and CD groups detected wide-spread differences in cerebral cortex thickness, subcortical structures grey matter volume, FA, and MD (@tbl-mri-pred-parcels). Regarding the macrostural correlates of post-surgery cognitive decline, CS patients had relatively higher cortical thickness in bilateral inferior parietal, insular, cingulate, sensorimotor, and visual cortices as well as higher volume of both putamina. Regarding the microstructural connectivity, analysis of DWi data detected higher FA in CS patients in medial temporal, inferior parietal, cingulate, and orbito-frontal cortex bilaterally as well as FA in the cerebellum and both hippocampi. The analysis further detected lower MD in CS patients' inferior parietal, orbito-frontal, dorsolateral prefrontal, and temporal cortices as well as both hippocampi and the left putamen. Both MD and FA detected bilateral differences between CS and CD subjects in the occipital cortex.

```{r}
#| label: tbl-mri-pred-parcels
#| tbl-cap: Results of parcellated comparison between patients with stable cognitive performance and  patients with declining cognitive performance.

read.csv( here("tabs","mripred_parcels.csv"), sep = ";" ) %>%
  
  gt( groupname_col = "group" ) %>%
  cols_align( align = "center", columns = -1 ) %>%
  cols_align( align = "left", columns = "Anatomical.cluster" ) %>%
  cols_label(
    Anatomical.cluster ~ "Anatomical cluster",
    d ~ "Cohen's d",
    `T` ~ "T-statistic",
    CS52 ~ "CS (N = 52)",
    CD20 ~ "CD (N = 20)",
    q ~ "q-value"
  ) %>%

  tab_spanner( label = "Descriptive statistics", columns = c("CS52","CD20"), gather = F ) %>%
  tab_spanner( label = "Inferential statistics", columns = c("d","T","q"), gather = F ) %>%
    
  text_transform(
    locations = cells_row_groups(),
    fn = function(x) sub( "mm2", "mm<sup>2</sup>", x )
  ) %>%
    
  tab_footnote(
    locations = cells_column_labels("Anatomical.cluster"),
    footnote = "Clusters with cortical anatomical localisation based on 22 main cortical segments and parcellation as defined by [@Glasser2016]"
  ) %>%
    
  tab_footnote(
    locations = cells_row_groups("Macrostructure (mm/unitless)"),
    footnote = "Values in mm for cortical thickness and unitless for subcortical grey matter structure volume, the latter was standardised by estimated intracranial volume."
  ) %>%
  
  tab_footnote(
    locations = cells_row_groups( c("Fractional Anisotropy (unitless)","Mean diffusivity  (1,000 × mm2/s)") ),
    footnote = "Results based on 46 CS and 16 CD patients"
  ) %>%
    
  tab_footnote(
    locations = cells_column_spanners("Descriptive statistics"),
    footnote = "values are presented as in-sample mean ± standarad deviation"
  ) %>%
  
  opt_footnote_marks(marks = "letters") %>%
  
  tab_source_note(
    source_note = "CS: cognitively stable patients; CD: cognitively declining patients; L: left; N: number of obseravtions; q-value: raw p-value after adjusting for 5% false discovery rate (FDR) level; R: right; ROI: number of parcellation regions of interest contained in each cluster."
  )

```

## The Instrumental Activities of Daily Living in Parkinson’s Disease Patients Treated by Subthalamic Deep Brain Stimulation

```{r}
#| label: postop-iadl-init

# read data
d <- read.csv( here("_data","postopIADL_data.csv"), sep = "," )
v2 <- read.csv( here("_data","item_nms.csv"), sep = ",", row.names = 1 )
pars <- read.table( here("_data","postopIADL_stimpars.txt"), header = T )
scl2 <- read.csv( here("_data","postopIADL_scales.csv"), sep = "," ) %>% column_to_rownames("var")

# transform the data from wide to long format over PDAQ items
df <-
  d %>%
  pivot_longer( cols = paste0( "pdaq_" , 1:15 ) , names_to = "item" , values_to = "resp" ) %>%
  mutate( item = as.integer( gsub( "^.*\\_" , "" , item ) ) ) %>%
  mutate(
    drs = ( drs - scl2["drs","M"] ) / scl2["drs","SD"],
    bdi = ( bdi - scl2["bdi","M"] ) / scl2["bdi","SD"],
    led = ( led - scl2["led","M"] ) / scl2["led","SD"],
    post = as.character(post),
    resp = as.ordered(resp)
  )

```

### Sample characteristics

Included patients characteristics are presented in @tbl-postop-iadl-desc. In general, no substantial post-surgery changes can be seen in objective cognitive performance (MDRS), depressive symptoms (BDI-II) or total IADL as measured by the PDAQ sum score. On the other hand, there was clear LEDD reduction after STN DBS and evidence of STN DBS reducing motor symptoms independently of dopaminergic medication.

```{r}
#| label: tbl-postop-iadl-desc
#| tbl-cap: Demographic, clinical, cognitive, and stimulation charactetistics of the sample.

tbl_iadl_desc <- 
  
  # prepare a bulk of the table
  d %>%
  group_by(post) %>%
  summarise(
    `Age (years)` = msd(age_neuropsy),
    `Education (years)` = msd(years_edu),
    `Sex (% male)` = rprint( 100 * sum(sex=="m") / length(sex) ),
    `LEDD (mg)` = msd(led),
    `PDAQ (range 0-60)` = msd( rowSums( across( starts_with("pdaq_") ) ) ),
    `MDRS (range 0-144)` = msd(drs),
    `BDI-II (range 0-63)` = msd(bdi)
  ) %>%
    
  # format it  
  pivot_longer( cols = -post, names_to = "var", values_to = "val" ) %>%
  pivot_wider( names_from = post, values_from = val ) %>%
  mutate( `1` = case_when( var == "Education (years)" ~ "-", var == "Sex (% male)" ~ "-", .default = `1` ) ) %>%
    
  # add some rows according to the paper
  add_row( var = "PD duration (years)", `0` = "11.37 ± 3.67", `1` = "-", .after = 3 ) %>%
  add_row( var = "Levodopa test (% response)", `0` = "58.42 ± 11.79", `1` = "-", .after = 8 ) %>%
  add_row( var = "MDS-UPDRS III (medication ON)", `0` = "18.76 ± 9.13", `1` = "-", .after = 9 ) %>%
  add_row( var = "MDS-UPDRS III (medication OFF)", `0` = "44.12 ± 15.05", `1` = "-", .after = 10 ) %>%
  add_row( var = "MDS-UPDRS III (stimulation ON)", `0` = "-", `1` = "26.25 ± 10.00", .after = 11 ) %>%
  add_row( var = "MDS-UPDRS III (stimulation OFF)", `0` = "-", `1` = "45.16 ± 14.04", .after = 12 ) %>%
    
  full_join(
    
    sapply( names(pars)[c(118:121,124:127)], function(i) msd( pars[[i]] ) ) %>%
      as.data.frame() %>%
      rename( "1" = "." ) %>%
      mutate(
        var = c("Current right (mA)","Pulse duration right (μs)","Frequency right (Hz)","Impedance right (kΩ)",
                "Current left (mA)","Pulse duration left (μs)","Frequency left (Hz)","Impedance left (kΩ)"
                ),
        `0` = "-",
        .before = 1
      ) %>%
      slice(1,5,2,6,3,7,4,8)
  
    ) %>%
  
    # add blocks
    mutate( block = c( rep("Demographic and clinical variables",5), rep("Neuropsychological outcomes",3), rep("Motor outcomes",5), rep("Stimulation parameters",8 ) ) )

# save it
write.table( x = tbl_iadl_desc, file = here("tabs","postopiadl_desc.csv"), sep = ",", row.names = F, quote = F )

# show it
tbl_iadl_desc %>%
  
  column_to_rownames("var") %>%
  
  gt( groupname_col = "block", rownames_to_stub = T ) %>%
  cols_align( -1, align = "center" ) %>%
  cols_label( `0` ~ "Pre-surgery", `1` = "Post-surgery" ) %>%
  
  tab_footnote(
    locations = cells_stub( rows = c("MDS-UPDRS III (stimulation ON)","MDS-UPDRS III (stimulation OFF)") ),
    footnote = "Post-surgery MDS-UPDRS III testing was done in the OFF mediation condition."
  ) %>%
  
  opt_footnote_marks(marks = "letters") %>%
  
  tab_source_note(
    source_note = "BDI-II: Beck Depression Rating Scale, second edition; DRS- 2: Dementia Rating Scale, second edition; Hz: Hertz; LEDD: levodopa equivalent daily dose; mA: milliamperes; MDS-UPDRS III: Movement Disorder Society Unified Parkinson’s Disease Rating Scale, motor part; μs: microseconds PDAQ-15: The Penn Parkinson’s Daily Activities Questionnaire-15. The values are presented as mean ± standard deviation percentage from the whole sample."
  )

```

### Post-surgery IADL change

```{r}
#| label: postop-iadl-mods

# set-up linear models
# meff = total effect of time ("main effect") (the 'masked' model, RQ4.1)
# teff = total effect of LEDD ("total effect") (the LEDD total effect model, RQ4.3)
# deff = direct effect of LEDD ("direct effect") (the direct effects model, RQ4.2)
f <- list(
  meff = bf( resp ~ 1 + post + ( 1 | id ) + ( 1 | item ) ) + cumulative("logit"),
  teff = bf( resp ~ 1 + post * led + ( 1 | id ) + ( 1 | item ) ) + cumulative("logit"),
  deff = bf( resp ~ 1 + post * led + post * drs + post * bdi + ( 1 | id ) + ( 1 | item ) ) + cumulative("logit")
)

# set-up priors (the same for all models)
p <- c(
  prior( student_t(3, 0, 2.5), class = b ),
  prior( student_t(3, 0, 2.5), class = Intercept ),
  prior( student_t(3, 0, 2.5), class = sd, group = id ),
  prior( student_t(3, 0, 2.5), class = sd, group = item )
)

# fit the models
m <-
  
  lapply(
    
    setNames( names(f), names(f) ),
    function(i)
      
      brm(
        formula = f[[i]], prior = p, data = df,
        seed = s, chains = ch, iter = it, warmup = wu,
        file = here( "mods", paste0("postopIADL_",i,".rds" ) ),
        save_model = here( "mods", paste0("postopIADL_",i,".stan" ) )
      )
    
  )

# extract the largest R hat
rhatmax <- ubound( max( sapply( names(m), function(i) max( rhat(m[[i]]), na.rm = T ) ) ) )

# extract raw group-level parameters
modpars <-
  
  lapply(
    
    names(m),
    function(i)
      
      describe_posterior( m[[i]], centrality = "median", ci = .95, ci_method = "hdi", test = "p_direction" ) %>%
      as.data.frame() %>%
      add_column( Model = i, .before = 1 )
    
  ) %>%
  
  do.call( rbind.data.frame, . ) %>%
  mutate(
    Median = rprint(Median,2),
    HDPI = paste0("[",rprint(CI_low,2),", ",rprint(CI_high,2),"]"),
    pd = rprint(pd,3)
  ) %>%
  select( Model, Parameter, Median, HDPI, pd )

# compute contrasts for RQ4.1 and RQ4.2
contr <-
  
  lapply(
    
    c("meff","deff"),
    function(i) {
      
      # posterior predictions at group level
      ppred <- posterior_epred( m[[i]], newdata = data.frame( post = c(0,1), led = 0, drs = 0, bdi = 0, id = NA, item = NA ), re_formula = NA )
    
    # subtract predicted post-minus-pre-surgery response probabilities
    c <- ppred[ , 2 , ] - ppred[ , 1 , ]
    
    # return summaries
    return(
      apply(
        100 * c,
        2,
        function(x)
          c( md = paste0( rprint( median(x), 1 ), "%" ),
             absmd = paste0( rprint( abs( median(x) ), 1 ), "%" ),
             dir = ifelse( median(x) == abs(median(x)), "increased", "decreased" ),
             hdpi = paste0( "[", rprint( hdci(x,.95)[1], 1 ), ", ", rprint( hdci(x,.95)[2], 1 ), "]" )
             )
        ) %>% t() %>% as.data.frame() %>% rownames_to_column("resp") %>% add_column( mod = i, .before = 1)
      )
    }
  ) %>% do.call( rbind.data.frame, . )

```

All GLMMs reported in this section converged to a stationary posterior distribution within specified number of iterations ($\hat{R}$s \< `r rhatmax`). Regarding the *RQ4.1*, the main effect of time of assessment (post-surgery-minus-pre-surgery) in the "descriptive" model was positive and of uncertain probability of effect existence ($\delta_{\text{Time}}$ = `r with( modpars, Median[Model == "meff" & Parameter == "b_post1"] )`, 95% HDPI `r with( modpars, HDPI[Model == "meff" & Parameter == "b_post1"] )`, *pd* = `r with( modpars, pd[Model == "meff" & Parameter == "b_post1"] )`). Consequently, without statistically adjusting for competing causes of post-surgery IADL change, the post-surgery probability that an average patient responds to an average PDAQ item with option zero (“cannot do”) `r with( contr, dir[mod == "meff" & resp == 0] )` by `r with( contr, absmd[mod == "meff" & resp == 0] )` (95% HDPI `r with( contr, hdpi[mod == "meff" & resp == 0] )`), the probability of response one (“a lot”) `r with( contr, dir[mod == "meff" & resp == 1] )` by `r with( contr, absmd[mod == "meff" & resp == 1] )` (95% HDPI `r with( contr, hdpi[mod == "meff" & resp == 1] )`), the probability of response two (“somewhat”) `r with( contr, dir[mod == "meff" & resp == 2] )` by `r with( contr, absmd[mod == "meff" & resp == 2] )` (95% HDPI `r with( contr, hdpi[mod == "meff" & resp == 2] )`), the probability of response three (“a little”) `r with( contr, dir[mod == "meff" & resp == 3] )` by `r with( contr, absmd[mod == "meff" & resp == 3] )` (95% HDPI `r with( contr, hdpi[mod == "meff" & resp == 3] )`), and the probability of response four (“none”) `r with( contr, dir[mod == "meff" & resp == 4] )` by `r with( contr, absmd[mod == "meff" & resp == 4] )` (95% HDPI `r with( contr, hdpi[mod == "meff" & resp == 4] )`).

Regarding the *RQ4.2*, the main effect of time of assessment in the "direct effect" model was positive and of high effect existence probability ($\delta_{\text{Time}}$ = `r with( modpars, Median[Model == "deff" & Parameter == "b_post1"] )`, 95% HDPI `r with( modpars, HDPI[Model == "deff" & Parameter == "b_post1"] )`, *pd* = `r with( modpars, pd[Model == "deff" & Parameter == "b_post1"] )`). When potential competing causes measured by MDRS, BDI-II and LEDD were statistically adjusted for, the post-surgery probability that an average patient responds to an average PDAQ item with option zero (“cannot do”) `r with( contr, dir[mod == "deff" & resp == 0] )` by `r with( contr, absmd[mod == "deff" & resp == 0] )` (95% HDPI `r with( contr, hdpi[mod == "deff" & resp == 0] )`), the probability of response one (“a lot”) `r with( contr, dir[mod == "deff" & resp == 1] )` by `r with( contr, absmd[mod == "deff" & resp == 1] )` (95% HDPI `r with( contr, hdpi[mod == "deff" & resp == 1] )`), the probability of response two (“somewhat”) `r with( contr, dir[mod == "deff" & resp == 2] )` by `r with( contr, absmd[mod == "deff" & resp == 2] )` (95% HDPI `r with( contr, hdpi[mod == "deff" & resp == 2] )`), the probability of response three (“a little”) `r with( contr, dir[mod == "deff" & resp == 3] )` by `r with( contr, absmd[mod == "deff" & resp == 3] )` (95% HDPI `r with( contr, hdpi[mod == "deff" & resp == 3] )`), and the probability of response four (“none”) `r with( contr, dir[mod == "deff" & resp == 4] )` by `r with( contr, absmd[mod == "deff" & resp == 4] )` (95% HDPI `r with( contr, hdpi[mod == "deff" & resp == 4] )`).

Panels A and B of @fig-postop-iadl-ce present expected pre- and post-surgery response probabilities of an average patient to an average PDAQ item according to the "descriptive" and "direct effect" models respectively. Coupled with the results presented in previous two paragraphs, the results imply that (i) there is only small and uncertain positive impact of STN DBS on IADL that could be observed in an average patient (as implied by the "descriptive" model), however, (ii) the direct causal effect of STN-DBS can be masked by post-surgery changes in competing causes of self-reported IADL difficulty and after accounting for these it appears to be reliably positive and larger than expected by average observational data only (as implied by the "direct effect" model), and (iii) the majority of post-surgery change in self-reported IADL is due to an increase of probability that a patient reports "no difficulties" (response four in PDAQ) instead of reporting "a little difficulties" (response three in PDAQ) whereas reporting high level of IADL difficulties is rare in this cohort.

```{r}
#| label: post-iadl-fig

theme_set( theme_bw( base_size = 14 ) )

# prepare a list with conditional effects of interest for RQ4.1 and RQ4.2
ce <- lapply( setNames( c("meff","deff"), c("RQ1","RQ2") ), function(i) conditional_effects( m[[i]], effects = "post", categorical = T ) )

# add LEDD effects for RQ4.3
ce$RQ3 <- conditional_effects( m$teff, effects = "led", categorical = T, conditions = make_conditions( m$teff, "post" ) )

# do some common pre-processing
for ( i in names(ce) ) {
  ce[[i]][[1]] <-
    ce[[i]][[1]] %>%
    mutate( `Response:` = recode(cats__ , "4" = '"none"', "3" = '"a little"' , "2" = '"somewhat"' , "1" = '"a lot"' , "0" = '"cannot do"' ) )
}

# prepare plots for postop changes (RQ4.1 and RQ4.2)
fig_ce <-
  
  lapply(
    
    setNames( c("RQ1","RQ2"), c("A","B") ),
    function(i)
      
      ce[[i]][["post:cats__"]] %>%
      ggplot() +
      aes( x = post, y = estimate__, ymin = lower__, ymax = upper__, color = `Response:` ) +
      geom_point( position = position_dodge(.66), size = 5 ) +
      geom_errorbar( position = position_dodge(.66), size = 1 , width = .5) +
      scale_x_discrete( name = NULL, labels = c("Pre-surgery","Post-surgery") ) +
      scale_y_continuous( name = "Probability of response (%)", limits = c(0,1) , breaks = seq(0,1,.1), labels = seq(0,100,10) ) +
      facet_wrap( ~case_when( i == "RQ1" ~ "Descriptive model", i == "RQ2" ~ "Direct effect model" ) ) +
      theme( legend.position = "none" )
    
  )

# prepare plot for LEDD model
fig_ce$C <-
  
  ce$RQ3$`led:cats__` %>%
  mutate( post = factor( ifelse(post == 0, "Pre-surgery", "Post-surgery"), levels = paste0(c("Pre","Post"),"-surgery"), ordered = T ) ) %>%
  
  ggplot() +
  aes(x = led, y = estimate__, ymin = lower__, ymax = upper__, color = `Response:`, fill = `Response:`) +
  geom_line( size = 1.5 ) +
  geom_ribbon( alpha = .1 , linetype = 0 ) +
  scale_x_continuous( name = "LEDD (mg)", labels = seq(500,4000,500), breaks = (seq(500,4000,500)-scl2["led","M"]) / scl2["led","SD"] ) +
  scale_y_continuous( name = "Probability of response (%)", limits = c(0,1) , breaks = seq(0,1,.1) , labels = seq(0,100,10) ) +
  facet_wrap( ~ post ) +
  theme( legend.position = "bottom" )

# save it
ggsave(
  plot = ( ( fig_ce$A | fig_ce$B ) / fig_ce$C ) + plot_annotation( tag_levels = "A" ),
  file = here("figs","postopiadl_pars.jpg"),
  dpi = 300,
  width = 9,
  height = 9
)

```

![Summaries of the marginal posterior distributions of expected response probabilities to an average item from The Penn Parkinson’s Daily Activities Questionnaire (PDAQ) by an average participant pre- and post-surgery according to the "descriptive" model (A), the "direct effect" model (B), and as a function of levodopa equivalent daily dose (LEDD) in the "total effect" model (C). Potential responses to PDAQ items are differentiated by colour, points and lines represent medians, and whiskers and shades represent 95% equal-tailed intervals (ETIs) of posterior distributions.](figs/postopiadl_pars.jpg){#fig-postop-iadl-ce}

### Effect of dopaminergic medication on post-surgery IADL

In the "total effect" model, the main effect of the time of assessment was positive with high effect existence probability ($\delta_{\text{Time}}$ = `r with( modpars, Median[Model == "teff" & Parameter == "b_post1"] )`, 95% HDPI `r with( modpars, HDPI[Model == "teff" & Parameter == "b_post1"] )`, *pd* = `r with( modpars, pd[Model == "teff" & Parameter == "b_post1"] )`), the main effect of LEDD was positive with high but uncertain probability of effect existence ($\beta_{\text{LEDD}}$ = `r with( modpars, Median[Model == "teff" & Parameter == "b_led"] )`, 95% HDPI `r with( modpars, HDPI[Model == "teff" & Parameter == "b_led"] )`, *pd* = `r with( modpars, pd[Model == "teff" & Parameter == "b_led"] )`), and the Time × LEDD interaction was positive with uncertain probability of effect existence ($\delta_{\text{LEDD}}$ = `r with( modpars, Median[Model == "teff" & Parameter == "b_post1:led"] )`, 95% HDPI `r with( modpars, HDPI[Model == "teff" & Parameter == "b_post1:led"] )`, *pd* = `r with( modpars, pd[Model == "teff" & Parameter == "b_post1:led"] )`). Posterior predictions of an average PDAQ item response probabilities by average patient as a function of time of assessment and LEDD are presented in @tbl-postop-iadl-ledd and panel C of @fig-postop-iadl-ce. These results imply that the statistically uncertain improvement in IADL as measured by the "descriptive" model can be partially explained by post-surgery LEDD reduction.

```{r}
#| label: tbl-postop-iadl-ledd
#| tbl-cap: Expected response probabilities of difficulty in IADL stratified by the time of assessment and levodopa equivalent daily dose derived from the total effect GLMM.

# extract posterior prediction
ppred <-
  
  posterior_epred(
    m$teff,
    newdata = data.frame(
        post = c( rep(0,11), rep(1,11) ) ,
        led = ( rep( seq(0, 5000, 500), 2 ) - scl2["led","M"] ) / scl2["led","SD"],
        id = NA, item = NA
    ),
    re_formula = NA
)

# prepare table
tbl_iadl_ledd <-
  
  sapply( 1:22, function(i) apply( 100*ppred[ , i, ], 2, msd, 1 ) ) %>%
  t() %>%
  as.data.frame() %>%
  rename_all( ~ paste0("P(resp = ",.x,")") ) %>%
  mutate_all( ~ paste0(.x,"%") ) %>%
  mutate( Assessment = c( rep("Pre-surgery",11), rep("Post-surgery",11) ), `LEDD (mg)` = rep( seq(0,5000,500), 2 ), .before = 1 )
    
# save it
write.table( x = tbl_iadl_ledd, file = here("tabs","postopiadl_ledd.csv"), sep = ",", row.names = F, quote = F )

# show it
tbl_iadl_ledd %>%
  
  mutate( `LEDD (mg)` = formatC( `LEDD (mg)`, big.mark = "," ) ) %>%
  gt( groupname_col = "Assessment" ) %>%
  cols_align( "LEDD (mg)", align = "left" ) %>%
  cols_align( -c(1:2), align = "center" ) %>%
  
  tab_source_note(
    source_note = "GLMM: generalized linear mixed model; IADL: instrumental activities of daily living; LEDD: levodopa equivalent daily dose; P(resp = i), probability that a patient responds to any item of The Penn Parkinson’s Daily Activities Questionnaire (PDAQ) with the response “i” where “i” represents difficulties in IADL and can take on values 0 = “cannot do,” 1 = “a lot,” 2 = “somewhat,” 3 = “a little,” and 4 = “none”; the numbers represent posterior predictions of the ordered-logit GLMM for an average patient to an average PDAQ item presented as posterior mean ± standard deviation."
  )


```

# Discussion

## Learning curve in verbal and non-verbal memory of patients with Parkinson's disease

In Study 1, we demonstrated that memory impairment profile of patients diagnosed with PD-MCI varies across sensory modalities (*RQ1.3*). Although patients with PD-MCI exhibited overall memory deficit in both visuospatial and auditory verbal free recall as compared to PD patients without MCI and healthy adults, the visuospatial memory deficit was characterised by impaired *retention* (*RQ1.1*) and relatively intact *learning curve* (*RQ1.2*) whereas the opposite pattern was observed in the auditory verbal memory.

Previous study from our research group investigating similar research questions reported PD-related deficit in visuospatial free recall (PD-MCI \< PD-NC \< HC) with no statistically reliable between-group differences in the *learning curve* (the *retention* as operationally defined in current study was not examined in the previous work)[@bezdicek2019]. Our current results thus do not completely coincide with these previous findings as unlike the previous study, we detected a statistically reliable *learning curve* deficit in PD-MCI patients' verbal auditory memory, and we did not detect a free recall deficit in PD-NC patients' visuospatial memory. However, some of these discrepancies may stem from the previous study having approximately half of our sample size leading to less precise estimates. Moreover, both studies imply that PD is associated with overall free recall deficit in visuospatial memory and that this deficit is especially pronounce in patients diagnosed with PD-MCI and does affect the *retention* without affecting the *learning curve*. Finally, @bronnick2011 concluded that patients with *de novo* PD already show *learning slope* deficit compared to healthy adults on a sample of 133 patients and 133 healthy controls.

Overall, the Study 1 demonstrates that MCI can lead to differential cognitive profiles in PD. This finding is important for assumptions of Study 2 which is the primary study of this thesis. More precisely, the Study 2 asks what pre-surgery cognitive profile is predictive of post-surgery cognitive decline in patients with PD treated by STN DBS. This research question comes with an implicit assumption that differences in pre-surgery cognitive profile that can be detected by neuropsychological testing are psychologically meaningful which is best demonstrated by comparing patients' cognitive profile to well selected control group. However, acquiring control group in the Study 2 research design would be ethically problematic. The Study 1 thus serves as a validation of the assumption that different cognitive profiles in neuropsychological examination imply psychologically meaningful differences corroborating inferences of Study 2.

## Preoperative Cognitive Profile Predictive of Cognitive Decline after Subthalamic Deep Brain Stimulation in Parkinson's Disease

In Study 2, we showed that although the expected post-surgery cognitive decline in patients with PD treated by STN DBS is gradual and rather slow on average, there exists high inter-individual variability across patients (*RQ2.1*). This inter-individual variability can be partially understood by measuring patients' pre-surgery cognitive profile because pre-surgery executive dysfunction reliably predicts faster rate of post-surgery cognitive decline (*RQ2.2*).

### Describing post-surgery cognitive change

The expected rate of average annual change in cognitive performance after STN DBS in our sample of PD patients was circa `r with( tcontr, absmedian[ level == 'group' & contrast == 'slope' ] )` from total 144 points in MDRS. Although sample-level uncertainty intervals were tightly clustered around this estimated, population-level inference and prediction uncertainty intervals were considerably larger implying high true score inter-individual heterogeneity and measurement error respectively. Nevertheless, the expected rate of cognitive decline fell below previously estimated reliable change cutoffs for MDRS [@pedraza2007] implying that STN DBS is relatively safe from cognitive standpoint at least in mid-term (i.e., up to three years post-surgery). Moreover, the rate of post-surgery cognitive decline observed in our sample was relatively lower than most previous records which reported change scores [@smeding2009; @gruber2019; @mangone2020; @reich2022] whereas other studies appear to observe similar to or larger post-surgery decline than our study, however, due to their lack of reporting score changes or regression slopes, they cannot be directly compared to our observations [@schupbach2005; @boel2016; @castrioto2022; @pal2022].

### Predicting post-surgery cognitive change

In our sample, pre-surgery executive functions/attention (EF/Att.) factor score was reliably predictive of the rate of post-surgery cognitive decline. Similar results were reported in previous studies which suggest that patients with pre-surgery executive deficit (operationally defined as performance on tasks such as Stroop test, Trail Making Test, Wisconsin Card Sorting Test or letter verbal fluency test) are at high risk of developing post-surgery dementia [@bove2020; @krishnan2019] and experiencing faster post-surgery cognitive decline [@smeding2009; @kim2014]. However, neither any other pre-surgery factor score nor any single pre-surgery test score reached level of statistical evidence implying effect existence in our analysis. To explain these findings relating to the predictive value of pre-surgery cognitive executive functions, authors usually refer to the dual syndrome hypothesis [@kehagia2010; @kehagia2012]. Following the dual syndrome hypothesis, general PD population is assumed to consist of patients with deficits (such as visuo-construction skills) associated with posterior cortical structures indicating high risk of rapid disease progression and short-term conversion to dementia, and patients with higher executive functions deficits associated with frontal cortical structures indicating slowly progressing dysexecutive syndrome. Since patients from the former group usually fail indication criteria for the STN DBS surgery, STN DBS treated patients tend to be sampled from the latter group and are thus likely to develop slowly progressing fronto-striatal executive impairment.

Study 2 adds to a substantial body of evidence implying that pre-surgery executive deficit is reliably predictive of post-surgery cognitive decline in patients with PD who were selected for STN DBS treatment via current recommended criteria [@defer1999; @armstrong2020]. Yet, it remains unclear which executive functions components provide the most information for predicting post-surgery cognitive decline. Our study can partially address this question courtesy of using two arguably distinct executive functions-related factors in the predictive model. Most importantly, the pre-surgery EF/Att. factor that is according to our data and models with high certainty reliably predictive of post-surgery cognitive decline was loaded on primarily by timed test scores. Consequently, this factor may reflect a general processing speed component of executive functions rather than any other high-level processes such as sensitivity to interference, set shifting proficiency or mental flexibility. Indeed, processing speed has been shown to be impaired in clinically cognitively intact patients with PD as well as being the primary executive component impaired in pre-clinical PD [@monchi2004; @sawada2012; @cholerton2021; @leitner2024]. The processing speed executive functions component may thus be a reliable marker of disease progression sensitive to biological determinants of cognitively high risk PD.

In contrast to the processing speed component of executive functions, our results of predictive value of pre-surgery set shifting factor score are indefinite. The set shifting factor reflected primarily performance in TMT-B, TMT-A, TOL, and RAVLT interference set recall (i.e., RAVLT-B). In accordance with previous research, set shifting and verbal working memory factor predicted pre-surgery MDRS performance cross-sectionally [@lopez2021]. However, neither set shifting nor verbal working memory were predictive of MDRS performance changes longitudinally (compare $\beta$ and $\delta$ parameters in @tbl-cog-pred-factors). These findings stay in opposition of the dual syndrome hypothesis predictions presented above as both set shifting and verbal working memory comprise executive function components linked to fronto-striatal circuitry [@emch2019; @bezdicek2021], yet these factors do not seem to be reliably predictive of post-surgery cognitive decline in PD. It needs to be noted, that in our study, the pre-surgery set shifting factor was inconsistently estimated across imputations in EFA (see @fig-cog-pred-factanal) which increased uncertainty in GLMMs related to it. Nonetheless, both psychometric advances in measuring processing speed-independent executive functions components as well as theoretical advances in the dual syndrome hypothesis will greatly benefit future understanding of cognitive profile related to high risk PD phenotypes for STN DBS.

Finally, recent meta-analysis identified both pre-surgery executive dysfunction as well as poorer pre-surgery memory to be reliably predictive of post-surgery cognitive decline [@jahanshahi2022]. Our results thus corroborate the former but oppose the latter finding of this meta-analysis.[^3] Nevertheless, as showed in Study 1, memory profile of PD patients can be further differentiated implying that the discrepancy between our results and conclusions of @jahanshahi2022 regarding pre-surgery memory predictive value can be explained by future studies examining more granular memory processes.

[^3]: Our results regarding predictive value of episodic memory are compatible with null hypothesis of no predictive value of pre-surgery episodic memory for post-surgery cognitive decline risk above and beyond information provided by the rest of pre-surgery cognitive profile (see @tbl-cog-pred-factors and @fig-cog-pred-pred).

## Structural and microstructural predictors of cognitive decline in deep brain stimulation of subthalamic nucleus in Parkinson’s disease

In Study 3, we mapped post-surgery cognitive decline to a widespread pre-surgery changes in macrostructural and microstructural brain characteristics in MRI. Importantly, the study shows that patients at risk of future post-surgery cognitive decline can be identified via relatively lower cortical thickness, subcortical structures volume and anatomical connectivity already at pre-surgery assessment even though the two groups (i.e., cognitively stable and cognitively declining patients) can be at the pre-surgery point equivalent from neuropsychological point of view. This finding imply that rather than being a side effect of stimulation itself, post-surgery cognitive decline reflects disease progression with latent changes present already at time of surgery in the form of lowered structural integrity or brain atrophy.

The brain areas associated with post-surgery cognitive decline were widespread in this study, including the expected sides such as basal ganglia as well as parietal, orbitofrontal and dorsolateral prefrontal cortices. However, several posterior structures were strongly implicated to correlate with post-surgery cognitive decline including both primary visual cortext as well as ventral and dorsal visual streams. These findings corroborate potential critiques of the dual syndrome hypothesis explanation for post-surgery cognitive decline raised in discussion of Study 2. More precisely, as stated above, the dual syndrome hypothesis explanation assumes that patients with primarily posterior cognitive deficits such as visuoconstruction impairments would be excluded from samples trearted with STN DBS due to the rapid disease progression. However, Study 3 shows that patient group at high risk of post-surgery cognitive decline show both frontal and posterior structural abnormalities in MRI.

Finally, the involvement of visual cortices in predicting post-surgery cognitive decline may aim attention to further confounding factors related to the results of Study 2. Namely, the majority of tests that significantly loaded on the EF/Att. factor were visually guided tasks with the exception of verbal fluency tasks. On top of considering the processing speed executive functions component to play crucial role in predicting post-surgery cognitive decline in PD patients treated by STN DBS, dissociating perceptual visual processes from higher-order executive functions is needed to fully characterise cognitive phenotypes of PD.

Overall, the main takeaway from Study 3 are as follows: (i) post-surgery cognitive decline seems to be related to disease progression rather than effects of stimulation itself, (ii) both frontal and subcortical as well as posterior brain structures' structural integrity is lower in pre-surgery assessment of patients with post-surgery cognitive decline, and consequently (iii) in addition to examination of higher order cognitive functions, deficits in perceptual faculties should be measured in neuropsychology assessment for risk stratification of patients with PD considered for STN DBS treatment.

## The Instrumental Activities of Daily Living in Parkinson’s Disease Patients Treated by Subthalamic Deep Brain Stimulation

In Study 4, we examined post-surgery changes in cognitively demanding IADLs and the possibility to affect these changes via intervention upon dopaminergic medication of patients with PD treated by STN DBS. Based on our models and data, only a small and uncertain improvement in IADLs can be observed one year post-surgery (*RQ4.1*), however, this may be mainly due to post-surgery changes in competing causes of IADL as after adjusting for the competing causes identified in this study, the expected "masked" post-surgery improvement in IADL is statistically reliable (*RQ4.2*). One of these competing causes, the amount of dopaminergic medication operationally defined as LEDD, can be used to affect post-surgery IADLs (*RQ4.3*).

The primary added value of this study comes from disentangling putative total and direct causal effects of STN DBS on self-reported IADLs in carefully selected PD patients.[^4] Whereas the the direct effect (*RQ4.2*) is large and reliable, its reflection in simple real life observation (i.e., the total effect, *RQ4.1*) is contaminated by STN DBS effects on other variables predictive of IADL change leading to a small and uncertain estimate. Most importantly, one important and desiderable outcome of STN DBS is dopaminergic medication reduction [@molinuevo2000; @russmann2004]. At the same time, our results imply that lowering LEDD leads to increase in IADL difficulties both pre- and post-surgery (with the effect being possibly larger after STN DBS surgery, see panel C of @fig-postop-iadl-ce). As a result of these opposing effects whereby STN DBS decreases IADL difficulties directly but indirectly increases it via reducing LEDD, medical professionals may want to carefully consider how much to reduce the LEDD after STN-DBS surgery in PD patients to avoid negative effects on IADL. For this purpose, @tbl-postop-iadl-ledd provides expectations of self-rated IADL difficulty response probabilities both pre- and post-surgery at different levels of LEDD.

[^4]: Since only patients already selected for STN DBS via criteria similar to the CAPSIT protocol [@defer1999] were included into the analysis, we cannot generalise our findings to other PD patients that may not pass CAPSIT-like inclusion/exclusion protocol without added assumptions such as exchangeability between different subpopulation of PD patients. From this reason, we limit our conclusions to patients that are already sutiable for STN DBS treatment.

Overall, Study 4 contributes to the discussion of cognitive decline in patients with PD treated by STN DBS via providing a bridge between objectively measured cognitive performance and patients' subjective experience of cognitive impairment affecting their everyday living. As major deficit in IADLs is a core definition feature of PD-D [@dubois2007; @emre2007; @goetz2008], the results of this study represent one of the first steps toward objective and transparent evaluation of PD-D after STN DBS. The study further differentiates itself from previous investigations of IADL difficulties in PD patients by focusing specifically on effects of STN DBS in a pre-test/post-test paradigm that goes over and beyond previously reported cross-sectional comparisons of IADL difficulties between patients with or without cognitive impairment in objective neuropsychological testing [@rosenthal2010; @pirogovsky2014; @foster2014; @becker2020; @cholerton2020; @foster2021; @becker2022; @schmitter-edgecombe2022].

## General Discussion

The results presented in this thesis indicate that there are psychologically meaningful differences in memory profile and by extension overall cognitive profile between patients with and without cognitive impairment [Study 1, @havlik2020], there is a slow gradual long-term cognitive decline with high inter-individual variability after STN DBS in PD patients that can be reliably predicted by pre-surgery processing speed component of executive functions [Study 2, @mana2024], patients with PD treated by STN DBS who experience post-surgery cognitive decline show signs of lowered structural integrity of subcortical structures as well as frontal and posterior cortical areas in pre-surgery MRI [Study 4, @filip2024], and STN DBS in PD patients leads to decrease in self-reported IADL difficulties that is partially masked by LEDD decrease after surgery in a short-term [Study 4, @bezdicek2022]. The primary aim of this thesis was to identify pre-surgery cognitive factors predictive of post-surgery dementia in PD patients treated with STN DBS. The most relevant answers to this question comes from the combination of Study 2 and Study 3 results.

### Dementia in Parkinson's disease

Major limitation of this thesis is that it investigated core diagnostic features of PD-D, namely the objective cognitive decline and IADL difficulties [@dubois2007; @emre2007; @goetz2008], without operationally defining PD-D itself in its compenent studies. Prior studies that examined pre-surgery predictors of post-surgery PD-D defined dementia retrospectively applying Diagnostic and Statistical Manual of Mental Disorders, Fifth Edition (DSM-5) criteria [@bove2020] or MDS Task Force clinical diagnostic criteria [@krishnan2019]. However, neither study provides sufficient information for reproduction of their diagnostic algorithm and due to their retrospective design, the validity of diagnosis cannot be ascertained. Unfortunately, if we were to define PD-D in studies presented in this article, we would encounter the same difficulties with retrospective design for PD-D diagnosis accuracy. And since both previously mentioned studies imply that PD-D is rather rare in PD patients after STN DBS in mid- to long-term, any diagnostic inaccuracies would be amplified. Consequently, this thesis focus on investigating single core diagnostic features of PD-D which can be measured with reasonable accuracy even when sampled retrospectively. Importantly, impairment of features investigated in this thesis is necessary (but not sufficient) condition for PD-D diagnosis and analysis of these features thus still provides information about post-surgery PD-D conversion.

### Constraints on generality

Severe constraints on generality apply to studies presented in this thesis. Most importantly, all studies investigating STN DBS outcomes presented here lack control group. Consequently, the results can be safely generalised only to STN DBS treated patients that were selected for treatment using similar exclusion criteria as those applied in studies presented here [i.e., the CAPSIT protocol criteria or their equivalent, @defer1999]. To extend generalisation to other PD populations, one would have to assert further assumptions such as exchangeability between patients who pass CAPSIT-like criteria and those that do not. However, as implied by for instance the dual syndrome hypothesis [@kehagia2010; @kehagia2012], this assumptions might be untenable. Due to this selection mechanism being applied to samples included in studies presented here, applying the results to select patients for STN DBS from a larger population of PD patients may lead to estimates distortion due to the collider bias [@cinelli2022]. I thus strongly advice against using the findings of this thesis as a basis for patient selection for STN DBS. Instead, the results can be used to single out patients who could benefit from more monitoring provided they were already selected for STN DBS treatment via the current best practices [@defer1999; @armstrong2020].

### Genetic profiling

Finally, a significant patient-specific variable not directly considered in this thesis that garnered attention lately is patients' genetic profile. Principally, heterozygous mutations in the glucocerebrosidase gene (GBA) have been associated with parkinsonism in general as well as faster cognitive decline in PD patients [@sidransky2012; @davis2016; @szwedo2016].

Several large sample recent studies implied an important role of GBA mutation in STN DBS treated PD patients specifically. @mangone2020 re-tested 208 patients (25 of which tested positively for GBA mutation) and observed substantially larger MDRS change score in GBA mutation carriers (GBA+) (*M* = -3.2, *SD* = 5.1) compared to patients without known genetic mutation (*M* = -1.4, *SD* = 4.4). @pal2022 published a large sample observational study of STN DBS treated patients with PD to date including both GBA+ and GBA mutation non-carriers (GBA-) as well as patients with and without STN DBS that included 366 subjects across 12 study sites followed for up to 5 years post-surgery. In this study, the results implied that GBA mutation is associated with fast cognitive decline specifically in STN DBS treated patients. Compared to GBA- patients with STN DBS, GBA+ patients with STN DBS showed decline circa 1.56 MDRS points/year faster [@pal2022]. Finally, @avenali2024 recently reported another large scale multicenter study including 365 patients (73 of which were GBA+) followed for up to 5 years showing that although GBA+ patients experience faster MDRS post-surgery decline, other clinical markers including motor and neuropsychiatric symptoms are similar between GBA+ and GBA- patients.

Since datasets used in this thesis do not include genetic profiling data, the results do not explicitly account for the GBA status of included patients. However, since the GBA mutation status is patient-specific time-invariant characteristic, the statistical model used in Study 2 does in principle adjust its estimates for this factor implicitly via estimating patient-level parameters [@mcelreath2020]. Presence of GBA+ patients in the dataset may thus partially explain the large inter-individual variability in true score changes identified by Study 2 (see @tbl-cog-pred-desc and @fig-cog-pred-desc). Interestingly, GBA mutation in PD was associated with deficits in verbal working memory, set shifting and visuospatial functions in PD [@mata2016]. This GBA-associated cognitive profile is almost identical to cognitive profile that was predictive of pre-surgery MDRS score cross-sectionally but was not predictive of post-surgery MDRS score longitudinally in Study 2 (compare $\beta$ and $\delta$ parameters in @tbl-cog-pred-factors). Further investigation into GBA association with cross-sectional cognitive profile, structural and functional brain characteristics, and longitudinal change of patients' cognitive profile after STN DBS would thus significantly benefit our understanding of biological mechanisms underlying cognitive side effects of PD and its interplay with STN DBS. Finally, new projects at the Movement Disorders Center, Department of Neurology at First Faculty of Medicine and General University Hospital in Prague were already commenced that include genetic profiling of patients with PD treated by STN DBS. So far, we tried to replicate results of @pal2022, however, GBA+ patients demonstrate very similar rate of post-surgery cognitive decline in our dataset (the project is being documented and publicly available at <https://github.com/josefmana/dbs_coGBA.git>).

# Conclusions

# Summary

# Souhrn

# References

# List of Publications

## Publications Related to the Thesis

## Publications Unrelated to the Thesis

# Supplement
